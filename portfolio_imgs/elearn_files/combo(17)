YUI.add("flickr-photos-removeTag-deletor",function(e){"use strict";function t(e,t){var n={};return n.tag_id=e,t.callAPI("flickr.photos.removeTag",n).then(null,function(e){throw t[e.fatal?"error":"debug"]("[flickr-photos-removeTag-deletor] failed getting or processing API response:",e),e})}e.namespace("ModelDeletors")["flickr-photos-removeTag"]={run:t}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("photo-tags-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-tags-getListPhoto"].run(t,this.appContext)},create:function(t){return e.ModelCreators["flickr-photos-addTags"].run(t,this.appContext)},"delete":function(t){return e.ModelDeletors["flickr-photos-removeTag"].run(t,this.appContext)}},attributes:{tags:{isListProxy:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-tags-getListPhoto-fetcher","flickr-photos-addTags-creator","flickr-photos-removeTag-deletor"]});
YUI.add("photo-title-desc-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(e){return this.photoId=e.photoId,this.full=e.full||!1,this.get("container").html===""&&this.setContainerHTML(""),this},loadState:function(){var e=this;return e.appContext.getModel("photo-models",e.photoId).then(function(t){e.set("photo",t)})},buildContainer:function(){var e=this.get("photo"),t=e.getValue("title"),n=e.getValue("description"),r={title:!1,desc:!1},i=!1,s=!1,o=!1,u=e.getValue("isOwner"),a;if(t.trim()===""||t.toUpperCase()==="<BR>")r.title=!0;return r.title&&u&&(t="add title"),t=this.removeLinkFromHash(t),n.trim()===""&&(r.desc=!0),r.desc&&u&&(n="add description"),r.desc&&r.title&&!u?i=!0:r.desc&&!u?o=!0:r.title&&!u&&(s=!0),a=this.templates("photo-title-desc")({title:t,description:n,empty:r,isOwner:u,noContentToDisplay:i,noTitleToDisplay:s,noDescToDisplay:o,enableCollapsableTitleAndDescription:this.appContext.flipper.isFlipped("enable-collapsable-title-and-description")}),this.setContainerHTML(a),this},showFull:function(e){this.full?e.target.getDOMNode().tagName.toUpperCase()!=="A"&&(e.preventDefault(),this.toggleTitleDesc({show:!1,showButton:!0})):this.toggleTitleDesc({show:!1,showButton:!0})},addLinkToHash:function(e){var t=/\s#[^#\s]+/gi,n;return n=e.replace(t,function(t,n,r){return n>0&&e.slice(n-1,1)==="&"?t:' <a class="server-only-link" href="/photos/tags/'+t.slice(2)+'">'+t.slice(1)+"</a>"}),n},removeLinkFromHash:function(e){var t=/<[^>]*>(.*?\s#[^#\s]+?.*?)<[\s]*\/[\s]*[^>]*>/gi,n;return n=e.replace(t,function(e,t,n){return t}),n},filterDuplicateTags:function(e,t){var n=/#[^#\s]+/gi,r,i=[];return t&&e&&(r=(e.match(n)||[]).map(function(e){return e.slice(1)}),i=t.filter(function(e){return r.indexOf(e.tagValue)===-1})),i},wrapDescription:function(e){var t=e.split("\n"),n=this;return t.length===1&&t[0]===""?"":t.map(function(e){return"<p>"+n.addLinkToHash(n.removeLinkFromHash(e))+"</p>\n"}).join("")},unwrapDescription:function(e){var t=e.split("</p>");return t.map(function(e){return e.replace(/(<p){1,1}([\s]+id="yui_[\d_]+"[.]*){0,1}>/g,"")}).filter(function(e){return e.trim()!==""}).join("").replace(/^(\n)+(.*)/g,"$2")},doneEditingAttr:function(t){var n=this.get("container"),r=this,i=this.get("photo"),s=n.one(".photo-title"),o=n.one(".photo-desc"),u=n.one(".edit-photo-title"),a=n.one(".edit-photo-desc"),f,l=u.get("value"),c=a.get("value"),h,p=i.getValue("title"),d=i.getValue("description"),v;n.removeClass("editing"),e.one("body").one(".editing-shim")&&e.one("body").one(".editing-shim").remove(),s.set("text",l),o.set("text",c),s.set("contenteditable",null),o.set("contenteditable",null),s.addClass("disabled"),o.addClass("disabled"),v=c.toString(),v=v.replace(/(#[^#\s]+)/gi,function(e,t,n,r){return n>0&&v.slice(n-1,n)==="&"?"":e}),h=(v.match(/(#[^#\s]+)/gi)||[]).map(function(e){return e.slice(1)}),i.setValue("title",l),i.setValue("description",c),h.length>0&&this.appContext.getModelRegistry("photo-tags-models").then(function(t){var n=[];return h.length>0&&n.push(t.remoteCreate({photoId:r.photoId,tags:h.join(",")})),e.batch.apply(r,n)}).then(function(t){t[0].length>0&&e.fire("flickr:photo-page--new-tags-added",t[0])},function(e){}),l===""||l.toUpperCase()==="<BR>"?(s.setHTML("add title"),s.addClass("placeholder-text")):s.removeClass("placeholder-text"),c===""||c.toUpperCase()==="<BR>"?(o.setHTML("add description"),o.addClass("placeholder-text")):o.removeClass("placeholder-text"),s.removeClass("show-editable"),u.removeClass("show-editable"),o.removeClass("show-editable"),a.removeClass("show-editable"),f=i.remoteUpdate(),f.then(function(){var t=i.getValue("title"),n=i.getValue("description");s.set("contenteditable","true"),o.set("contenteditable","true"),s.removeClass("disabled"),o.removeClass("disabled"),t===""?(s.setHTML("add title"),s.addClass("placeholder-text")):(s.set("text",t),s.setHTML(r.addLinkToHash(s.get("text").replace(/</g,"&lt;").replace(/>/g,"&gt;")))),n===""?(o.setHTML("add description"),o.addClass("placeholder-text")):o.setHTML(e.Handlebars.helpers.photoDescription(n).toString()),this.appContext.flipper.isFlipped("enable-collapsable-title-and-description")&&r.toggleTitleDesc({show:!1,noEffect:!0})},function(t){i.setValue("title",p),i.setValue("description",d),r.fire("subviewViewEvent","getDialogOffset",function(t){var n=e.Views.dialog.getInstance("dialog-alert",{content:"We couldn't change the Title and Description at this time.",attrs:{title:"Error",level:"warning",confirmLabel:"OK"},appContext:r.appContext,offsetLeft:t});n.show()}),s.set("contenteditable","true"),o.set("contenteditable","true"),s.removeClass("disabled"),o.removeClass("disabled"),i.getValue("title")===""?(s.setHTML("add title"),s.addClass("placeholder-text")):(s.set("text",i.getValue("title")),s.setHTML(r.addLinkToHash(s.get("text").replace(/</g,"&lt;").replace(/>/g,"&gt;")))),i.getValue("description")===""?(o.setHTML("add description"),o.addClass("placeholder-text")):o.setHTML(e.Handlebars.helpers.photoDescription(i.getValue("description")).toString()),r.toggleTitleDesc({show:!1,noEffect:!0})})},startEditingAttr:function(t){var n=this,r=this.get("container"),i=this.get("photo"),s=i.getValue("title"),o=i.getValue("description"),u=r.one(".photo-title"),a=r.one(".photo-desc"),f=r.one(".edit-photo-title"),l=r.one(".edit-photo-desc"),c=r.one(".false-edit-photo-title"),h=r.one(".false-edit-photo-desc"),p,d,v;if(u.hasClass("disabled")||a.hasClass("disabled"))return;r.addClass("editing"),e.one("body").append('<div class="editing-shim" style="top:0;width:100%;height:100%;position:absolute;z-index:50;">&nbsp;</div>').setStyle("display","block"),this.registerEventHandler(e.one("body").one(".editing-shim").on("click",function(){n.doneEditingAttr()},this)),this.registerEventHandler(e.one("body").one(".editing-shim").on("focus",function(){n.doneEditingAttr()},this)),p=s,d=o,u.hasClass("placeholder-text")&&(p="",f.set("placeholder","add title")),a.hasClass("placeholder-text")?(d="",l.set("placeholder"
,"add description"),l.set("value",this.unwrapDescription(d)),h.set("value",this.unwrapDescription(d))):(v=d.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<"),l.set("value",this.unwrapDescription(v)),h.set("value",this.unwrapDescription(v))),f.set("value",this.unwrapDescription(p)),c.set("value",this.unwrapDescription(p)),f.setStyle("height",c._node.scrollHeight+"px"),f.setStyle("minHeight",c._node.scrollHeight+"px"),f.addClass("show-editable"),u.addClass("show-editable"),l.setStyle("height",h._node.scrollHeight+"px"),l.setStyle("minHeight",h._node.scrollHeight+"px"),l.addClass("show-editable"),a.addClass("show-editable"),r.one(t).focus(),r.one(t).getDOMNode().setSelectionRange(0,r.one(t).getDOMNode().value.length),this.toggleTitleDesc({showButton:!1,show:!0,noEffect:!0})},toggleTitleDesc:function(e){var t=this.get("container"),n;this.full=e.show||!this.full,this.full?(e.noEffect||this.fire("flickr:expand-sidebar"),t.one(".title-desc-block").addClass("showFull")):(t.one(".title-desc-block").removeClass("showFull"),e.noEffect||this.fire("flickr:collapse-sidebar")),t.one(".title-desc-more-button")&&(this.toggleTitleDescTruncationButton(),n=typeof e.showButton!="undefined"?e.showButton:this.titleDescHasOverflow(),this.showMoreButton(n))},toggleTitleDescTruncationButton:function(){var e=this.get("container");this.full?e.one(".title-desc-more-button").setHTML("less"):e.one(".title-desc-more-button").setHTML("more")},showMoreButton:function(e){var t=this.get("container"),n=t.one(".title-desc-more-button");e?n.addClass("title-desc-has-overflow"):n.removeClass("title-desc-has-overflow")},titleDescHasOverflow:function(){var e=this.get("container"),t=e.one(".title-desc-block"),n=t.getDOMNode(),r=t&&t.getComputedStyle?parseInt((t.getComputedStyle("maxHeight")||n.clientHeight+"").replace("px",""),10):n.clientHeight;return n.clientHeight<n.scrollHeight&&n.scrollHeight>r},activate:function(){var e=this.get("container"),t=this.get("photo"),n=e.one(".title-desc-more-button"),r=this;return e&&(e.one(".photo-title")&&e.one(".photo-title").setHTML(this.addLinkToHash(e.one(".photo-title").getHTML())),n&&r.showMoreButton(r.titleDescHasOverflow())),n&&r.registerEventHandler(n.on("click",r.showFull,r)),t&&t.getValue("isOwner")&&[{field:".photo-title",editField:".edit-photo-title",editFalseField:".false-edit-photo-title"},{field:".photo-desc",editField:".edit-photo-desc",editFalseField:".false-edit-photo-desc"}].forEach(function(t){if(!r.appContext.flipper.isFlipped("tags-charm")||t.field!==".photo-tags")r.registerEventHandler(e.one(t.field).on("click",function(){r.startEditingAttr(t.editField)},r)),r.registerEventHandler(e.one(t.editField).on("input",function(n){e.one(t.editFalseField).set("value",e.one(t.editField).get("value")),e.one(t.editField).setStyle("height",e.one(t.editFalseField)._node.scrollHeight+"px"),e.one(t.editField).setStyle("minHeight",e.one(t.editFalseField)._node.scrollHeight+"px")})),r.registerEventHandler(e.one(t.editField).on("keydown",function(n){n.charCode===13&&!n.altKey&&!n.shiftKey?(n.preventDefault(),r.doneEditingAttr(),e.one(t.editField).blur()):(e.one(t.editFalseField).set("value",e.one(t.editField).get("value")),e.one(t.editField).setStyle("height",e.one(t.editFalseField)._node.scrollHeight+"px"),e.one(t.editField).setStyle("minHeight",e.one(t.editFalseField)._node.scrollHeight+20+"px"))}))}),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-photo-title-desc","photo-title-desc-css","array-extras","handlebars-helpers"],optional:["photo-models","photo-tags-models"]});
YUI.add("hermes-template-photo-stats",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){return'\n	<li class="view-count">\n		<span class="view-count-label">&nbsp;</li>\n	</li>\n'}function h(e,t){var r="",i,s,o;r+='\n	<li class="view-count">\n		<span class="stat-icon ui-icon-tiny-view-count">&nbsp;</span>\n		<span class="view-count-label">',o={hash:{},data:t},r+=a((i=n.friendlyNumber||e.friendlyNumber,i?i.call(e,(i=e.engagement,i==null||i===!1?i:i.viewCount),o):l.call(e,"friendlyNumber",(i=e.engagement,i==null||i===!1?i:i.viewCount),o)))+'</span>\n	</li>\n	<li class="date-taken">\n		<span class="stat-icon ui-icon-tiny-date">&nbsp;</span>\n		<span class="date-taken-label" title="Uploaded ',o={hash:{},data:t},r+=a((i=n.friendlyDate||e.friendlyDate,i?i.call(e,(i=e.stats,i==null||i===!1?i:i.datePosted),3,o):l.call(e,"friendlyDate",(i=e.stats,i==null||i===!1?i:i.datePosted),3,o)))+'">',o={hash:{},data:t},r+=a((i=n.friendlyDate||e.friendlyDate,i?i.call(e,(i=e.stats,i==null||i===!1?i:i.dateTaken),(i=e.stats,i==null||i===!1?i:i.takenGranularity),o):l.call(e,"friendlyDate",(i=e.stats,i==null||i===!1?i:i.dateTaken),(i=e.stats,i==null||i===!1?i:i.takenGranularity),o)))+"</span>\n	</li>\n	",s=n["if"].call(e,e.isOwner,{hash:{},inverse:f.noop,fn:f.program(4,p,t),data:t});if(s||s===0)r+=s;return r+="\n",r}function p(e,t){var r="",i,s,o;r+='\n	<li class="privacy-control">\n		<div class="ui-dropdown ui-dropdown-alignright ui-dropdown-noarrow ui-dropdown-closed">\n			<span data-action="toggle">\n				<i class="ui-icon-tiny-privacy',(i=n.privacySelected)?i=i.call(e,{hash:{},data:t}):(i=e.privacySelected,i=typeof i===u?i.apply(e):i),r+=a(i)+'">\n					<span class="charm-ui-error" title="There was an error while updating the privacy. Please try again."></span>\n				</i>\n			</span>\n			<span class="ui-dialog-arrow"></span>\n			<ul>\n				',o={hash:{},inverse:f.noop,fn:f.program(5,d,t),data:t},s=(i=n.eachConfigVal||e.eachConfigVal,i?i.call(e,"privacy",o):l.call(e,"eachConfigVal","privacy",o));if(s||s===0)r+=s;return r+="\n			</ul>\n		</div>\n	</li>\n	",r}function d(e,t){var r="",i;return r+='\n				<li data-action="set" data-value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===u?i.apply(e):i),r+=a(i)+'" data-text="',(i=n.text)?i=i.call(e,{hash:{},data:t}):(i=e.text,i=typeof i===u?i.apply(e):i),r+=a(i)+'">',(i=n.text)?i=i.call(e,{hash:{},data:t}):(i=e.text,i=typeof i===u?i.apply(e):i),r+=a(i)+"</li>\n				",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this,l=n.helperMissing;s+='<ul class="photo-stats clear-float">\n',o=n["if"].call(t,t.loadingView,{hash:{},inverse:f.program(3,h,i),fn:f.program(1,c,i),data:i});if(o||o===0)s+=o;return s+="\n</ul>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-stats",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-stats-view",function(e){var t={stateCSS:{working:"working",apiError:"api-error"}};e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(e){this.photoId=e.photoId,this.nsid=e.nsid;if(this.get("container").get("innerHTML")===""){var t=this.templates("photo-stats")({stats:{},engagement:{},privacy:{},privacySelected:"",isOwner:!1,loadingView:!0});this.setContainerHTML(t)}return this},loadState:function(){var t=this,n;return n=new e.FlickrPromise({stats:this.appContext.getModel("photo-stats-models",this.photoId),engagement:this.appContext.getModel("photo-engagement-models",this.photoId),privacy:this.appContext.getModel("photo-privacy-models",this.photoId),relationship:this.appContext.getModel("person-relationship-models",this.nsid)}),n.then(function(e){t.set("stats",e.stats),t.set("engagement",e.engagement),t.set("privacy",e.privacy),t.set("relationship",e.relationship)},this.appContext.warn.bind(this))},buildContainer:function(){var e,t;return e={stats:this.get("stats")?this.get("stats").toJSON():{},engagement:this.get("engagement")?this.get("engagement").toJSON():{},privacy:this.get("privacy")?this.get("privacy").toJSON():{},privacySelected:this.get("privacy")?this.mapPrivacy(this.get("privacy").toJSON()):"",isOwner:this.get("relationship")?this.get("relationship").getValue("isMe"):!1},t=this.templates("photo-stats")(e),this.setContainerHTML(t),this},activate:function(){var t=this,n,r,i,s=this.get("privacy"),o=this.get("stats"),u=this.get("container").one(".date-taken");return o&&this.registerEventHandler(o.on("valuesChanged",function(t){r=t.dateTaken?e.moment(t.dateTaken.newVal):e.moment(o.getValue("dateTaken")),i=t.takenGranularity?t.takenGranularity.newVal:o.getValue("takenGranularity"),i===8?n="Circa "+r.format("YYYY"):i===6?n="Sometime in "+r.format("YYYY"):i===4?n=r.format("MMMM YYYY"):n=r.format("MMMM D, YYYY"),u.one(".date-taken-label").set("text",n),r=t.datePosted?e.moment(t.datePosted.newVal,"X"):e.moment(o.getValue("datePosted"),"X"),u.one(".date-taken-label").setAttribute("title",r.format("MMMM D, YYYY"))})),s&&this.registerEventHandler(s.on("valuesChanged",function(e){var n=t.get("container").one(".privacy-control i"),r=t.mapPrivacy(s.toJSON());n.hasClass("ui-icon-tiny-privacy"+r.toLowerCase())||t.privacyDd.select(r)})),this.privacyDd=new e.Views.Dropdown({appContext:this.appContext,container:this.get("container").one(".privacy-control .ui-dropdown"),activate:!1,selected:this.mapPrivacy(this.get("privacy").toJSON()),disabled:!this.get("relationship").getValue("isMe")}),this.privacyDd.update=function(t,n,r){var i=this.labelEl.one("i"),s=this.get("selected"),o=this;this.get("container").all(r.css.items).removeClass(r.css.itemSelected),e.Array.each(s,function(e){o._items[e]&&o._items[e].node.addClass(r.css.itemSelected)});if(!i)return;t||(t=s[0]),i.getDOMNode().className="ui-icon-tiny-privacy"+t.toLowerCase()},this.privacyDd.activate(),this.privacyDd.on("open",function(n){e.rapidTracker.beacon(t.name,"privacySettingMenuClick")}),this.privacyDd.on("selected",function(e){t.setPrivacy(e.clicked.value)}),this.on("destroy",function(){t.privacyDd.destroy()}),this},setPrivacy:function(e){var n=this.get("privacy"),r=this.get("container").one(".privacy-control"),i=this.mapPrivacy(e),s;Object.keys(i).forEach(function(e){n.setValue(e,i[e])}),r&&r.addClass(t.stateCSS.working),n.remoteUpdate().then(function(){r&&(r.removeClass(t.stateCSS.working),r.removeClass(t.stateCSS.apiError))},function(e){Object.keys(i).forEach(function(e){n.revertValue(e)}),r&&(r.removeClass(t.stateCSS.working),r.addClass(t.stateCSS.apiError)),window.setTimeout(function(){r&&r.addClass(t.stateCSS.apiError)},100),s=this.mapPrivacy(n.toJSON()),self.onError("There was a problem changing your photo's privacy"),self.appContext.error(e)}.bind(self))},mapPrivacy:function(e){var t,n,r,i,s;t=[["public",["isPublic"]],["friendsandfamily",["isVisibleByFriends","isVisibleByFamily"]],["friends",["isVisibleByFriends"]],["family",["isVisibleByFamily"]],["private",[]]];if(typeof e=="object"){for(n=0,r=t.length;n<r;n++){i=t[n];if(!i[1].length||i[1].every(function(t){return!!e[t]}))return i[0]}return null}s={};for(n=0,r=t.length;n<r;n++)i=t[n],i[1].forEach(function(t){s[t]=i[0]===e?!0:s[t]||!1});return s}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-stats","promise","photo-stats-css","dialog"],optional:["photo-stats-models","photo-engagement-models","dropdown"]});
YUI.add("hermes-template-photo-license",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){var r="",i,s,o;r+="\n            ",i=n["if"].call(e,e.licenseIsCreativeCommons,{hash:{},inverse:l.program(4,p,t),fn:l.program(2,h,t),data:t});if(i||i===0)r+=i;r+="\n            ",i=n["if"].call(e,e.licenseisGovt,{hash:{},inverse:l.noop,fn:l.program(6,d,t),data:t});if(i||i===0)r+=i;r+="\n            ",i=n["if"].call(e,e.licenseisNoLic,{hash:{},inverse:l.noop,fn:l.program(8,v,t),data:t});if(i||i===0)r+=i;r+="\n            ",i=n["if"].call(e,e.licenseisCopy,{hash:{},inverse:l.noop,fn:l.program(10,m,t),data:t});if(i||i===0)r+=i;r+='\n        </a>\n        <div class="ui-dropdown ui-dropdown-closed">\n            <span class="ui-dialog-arrow"></span>\n            <ul>\n                ',o={hash:{},inverse:l.noop,fn:l.program(12,g,t),data:t},s=(i=n.eachConfigVal||e.eachConfigVal,i?i.call(e,"licenseSelect",o):u.call(e,"eachConfigVal","licenseSelect",o));if(s||s===0)r+=s;return r+="\n            </ul>\n        </div>\n    ",r}function h(e,t){var r="",i,s,o;return r+='\n                <a href="',o={hash:{},data:t},r+=a((i=n.configVal||e.configVal,i?i.call(e,"licenseUrls",e.license,o):u.call(e,"configVal","licenseUrls",e.license,o)))+'" class="photo-license-url-iconOnly" rel="license cc:license" target="_newtab">\n                <i class="ui-icon-tiny-',(s=n.license)?s=s.call(e,{hash:{},data:t}):(s=e.license,s=typeof s===f?s.apply(e):s),r+=a(s)+'cc"></i>\n            ',r}function p(e,t){var r="",i,s;return r+='\n                <a href="',s={hash:{},data:t},r+=a((i=n.configVal||e.configVal,i?i.call(e,"licenseUrls",e.license,s):u.call(e,"configVal","licenseUrls",e.license,s)))+'" class="photo-license-url-iconOnly" rel="license" target="_newtab">\n            ',r}function d(e,t){return'\n                <i class="ui-icon-tiny-government"></i>\n            '}function v(e,t){return'\n                <i class="ui-icon-tiny-noKnown"></i>\n            '}function m(e,t){return'\n                <i class="ui-icon-tiny-copyright"></i>\n            '}function g(e,t){var r="",i,s;return r+='\n                    <li data-action="set" data-value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===f?i.apply(e):i),r+=a(i)+'" data-text="',s={hash:{intlName:e.key},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+'">',s={hash:{intlName:e.key},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"</li>\n                ",r}function y(e,t){var r="",i,s,o;r+='\n		<a href="',o={hash:{},data:t},r+=a((i=n.configVal||e.configVal,i?i.call(e,"licenseUrls",e.license,o):u.call(e,"configVal","licenseUrls",e.license,o)))+'" class="photo-license-url" rel="license cc:license" target="_newtab">\n			',s=n["if"].call(e,e.licenseIsCreativeCommons,{hash:{},inverse:l.program(17,w,t),fn:l.program(15,b,t),data:t});if(s||s===0)r+=s;r+="\n			",s=n["if"].call(e,e.licenseisGovt,{hash:{},inverse:l.noop,fn:l.program(19,E,t),data:t});if(s||s===0)r+=s;r+="\n			",s=n["if"].call(e,e.licenseisNoLic,{hash:{},inverse:l.noop,fn:l.program(21,S,t),data:t});if(s||s===0)r+=s;r+="\n			",s=n["if"].call(e,e.licenseisCopy,{hash:{},inverse:l.noop,fn:l.program(23,x,t),data:t});if(s||s===0)r+=s;r+="\n			",s=n["if"].call(e,e.licenseIsCreativeCommons,{hash:{},inverse:l.program(27,N,t),fn:l.program(25,T,t),data:t});if(s||s===0)r+=s;return r+="\n		</a>\n    ",r}function b(e,t){var r="",i;return r+='\n				<i class="ui-icon-tiny-',(i=n.license)?i=i.call(e,{hash:{},data:t}):(i=e.license,i=typeof i===f?i.apply(e):i),r+=a(i)+'cc"></i>\n			',r}function w(e,t){var r="",i,s;return r+='\n				<a href="',s={hash:{},data:t},r+=a((i=n.configVal||e.configVal,i?i.call(e,"licenseUrls",e.license,s):u.call(e,"configVal","licenseUrls",e.license,s)))+'" class="photo-license-url" rel="license" target="_newtab">\n			',r}function E(e,t){return'\n				<i class="ui-icon-tiny-government"></i>\n			'}function S(e,t){return'\n				<i class="ui-icon-tiny-noKnown"></i>\n			'}function x(e,t){return'\n				<i class="ui-icon-tiny-copyright"></i>\n			'}function T(e,t){var r="",i,s;return r+="\n				<span>",s={hash:{intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"</span>\n			",r}function N(e,t){var r="",i,s;return r+="\n				<span>",s={hash:{},data:t},r+=a((i=n.configVal||e.configVal,i?i.call(e,"licenseDisplay",e.license,s):u.call(e,"configVal","licenseDisplay",e.license,s)))+"</span>\n			",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=n.helperMissing,a=this.escapeExpression,f="function",l=this;s+=' <div class="photo-license-info">\n    ',o=n["if"].call(t,t.licenseIsEditable,{hash:{},inverse:l.program(14,y,i),fn:l.program(1,c,i),data:i});if(o||o===0)s+=o;return s+="\n </div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-license",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-license-view",function(e){var t;t={debug:!1,css:{license:".photo-license-info .ui-dropdown"},stateCSS:{working:"working",apiError:"api-error"}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.photoId=t.photoId,this.context=e.clone(t.context,!0),this.get("container").html===""&&this.setContainerHTML(""),this},buildContainer:function(){var e,t=this.get("photo"),n=t.getValue("isOwner"),r=t?t.getValue("license"):"none";return e=this.templates("photo-license")({license:r,licenseIsEditable:n&&r!==7&&r!==8,licenseIsCreativeCommons:r!==0&&r!==7&&r!==8,licenseisGovt:r===8,licenseisNoLic:r===7,licenseisCopy:r===0}),this.setContainerHTML(e),this},loadState:function(){var t=this,n=new e.FlickrPromise({photo:t.appContext.getModel("photo-models",t.photoId)});return n.then(function(e){t.set("photo",e.photo)})},setLicense:function(e){var n=this.get("photo"),r=n.getValue("license"),i=this.mapLicenseUrl(r),s=this.get("container").one(".photo-license-info"),o=this.get("container").one(".photo-license-info a"),u=parseInt(e,10)!==0&&parseInt(e,10)!==7&&parseInt(e,10)!==8,a=this.mapLicenseUrl(e),f=this;s&&(s.removeClass(t.stateCSS.apiError),s.addClass(t.stateCSS.working)),n.setValue("license",e),u?(o.one("i").removeClass("ui-icon-tiny-copyright"),o.one("i").removeClass("ui-icon-tiny-"+r+"cc"),o.one("i").addClass("ui-icon-tiny-"+e+"cc"),this.get("container").one(".photo-license-url-iconOnly").set("rel","license cc:license")):(o.one("i").removeClass("ui-icon-tiny-"+r+"cc"),o.one("i").addClass("ui-icon-tiny-copyright"),this.get("container").one(".photo-license-url-iconOnly").set("rel","license")),o.setAttribute("href",a),n.remoteUpdate().then(function(){s&&s.removeClass(t.stateCSS.working)},function(e){n.setValue("license",r),f.licenseDd.select(r),o.setAttribute("href",i),s&&(s.removeClass(t.stateCSS.working),s.addClass(t.stateCSS.apiError)),f.onError(f.intlMessage({intlName:"photo-page-scrappy.LICENSE_ERROR"})),f.appContext.error(e)}.bind(this))},mapLicenseUrl:function(e){var t=["/help/general/#147","https://creativecommons.org/licenses/by-nc-sa/2.0/","https://creativecommons.org/licenses/by-nc/2.0/","https://creativecommons.org/licenses/by-nc-nd/2.0/","https://creativecommons.org/licenses/by/2.0/","https://creativecommons.org/licenses/by-sa/2.0/","https://creativecommons.org/licenses/by-nd/2.0/","/commons/usage/","http://www.usa.gov/copyright.shtml"];return t[e]},mapLicense:function(e){var t=[this.intlMessage({intlName:"photo-page-scrappy.ALL_RIGHTS_RESERVED"}),this.intlMessage({intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"}),this.intlMessage({intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"}),this.intlMessage({intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"}),this.intlMessage({intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"}),this.intlMessage({intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"}),this.intlMessage({intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"}),this.intlMessage({intlName:"photo-page-scrappy.NO_RESTRICTIONS"}),this.intlMessage({intlName:"photo-page-scrappy.USA_GOV_WORK"})];return t[e]},activate:function(){var n=this.get("container"),r=this.get("photo"),i=this;return this.licenseDd=new e.Views.Dropdown({appContext:this.appContext,container:n.one(t.css.license),selected:r.getValue("license"),disabled:!r.getValue("isOwner"),labelFunction:function(e){return i.mapLicense(r.getValue("license"))}}),this.licenseDd.on("open",function(t){i.fire("viewEvent","make in view",i.licenseDd.get("container")),e.rapidTracker.beacon(i.name,"licenseSettingMenuClick")}),this.licenseDd.on("close",function(e){i.fire("viewEvent","close in view")}),this.licenseDd.on("selected",function(e){i.setLicense(e.clicked.value)}),this.on("destroy",function(){i.licenseDd.destroy()}),this}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-license","photo-license-css"],langBundles:["common","photo-page-scrappy","settings"]});
YUI.add("hermes-lang-settings",function(e,t){e.Intl.add("hermes/settings","en-US",{SAFE:["Safe"],MODERATE:["Moderate"],RESTRICTED:["Restricted"],PUBLIC:["Public"],PRIVATE:["Private"],FRIENDS:["Friends"],FAMILY:["Family"],FRIENDS_AND_FAMILY:["Friends & Family"],ONLY_YOU:["Only you"],PEOPLE_YOU_FOLLOW:["People you follow"],ANY_FLICKR_MEMBER:["Any Flickr member"],SOME_RIGHTS_RESERVED:["Some rights reserved"],ALL_RIGHTS_RESERVED:["All rights reserved"],ATTRIBUTION:["Attribution"],ATTRIBUTION_SHAREALIKE:["Attribution-ShareAlike"],ATTRIBUTION_NODERIVS:["Attribution-NoDerivs"],ATTRIBUTION_NONCOMMERCIAL:["Attribution-NonCommercial"],ATTRIBUTION_NONCOMMERCIAL_SHAREALIKE:["Attribution-NonCommercial-ShareAlike"],ATTRIBUTION_NONCOMMERCIAL_NODERIVS:["Attribution-NonCommercial-NoDerivs"],NO_COPYRIGHT_RESTRICTIONS:["No known copyright restrictions"],US_GOV_WORK:["United States government work"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-photo-sidebar-actions",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){var r,i;return i={hash:{},data:t},l((r=n.formatNumber||e.formatNumber,r?r.call(e,(r=e.photo,r==null||r===!1?r:r.commentCount),i):f.call(e,"formatNumber",(r=e.photo,r==null||r===!1?r:r.commentCount),i)))}function p(e,t){var r,i;return i={hash:{},data:t},l((r=n.friendlyNumber||e.friendlyNumber,r?r.call(e,(r=e.photo,r==null||r===!1?r:r.commentCount),i):f.call(e,"friendlyNumber",(r=e.photo,r==null||r===!1?r:r.commentCount),i)))}function d(e,t){var r="",i,s;return r+="\n	",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["more-menu-view"],s):f.call(e,"outlet",e["more-menu-view"],s)))+"\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression,c=this;a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["fave-view"],a):f.call(t,"outlet",t["fave-view"],a)))+'\n<div>\n	<a title="Comment" class="button comment" href="#">\n		<span class="ui-icon-comments">&nbsp;</span>\n		<span class="button-comment-count">',u=n["if"].call(t,t.realFullscreen,{hash:{},inverse:c.program(3,p,i),fn:c.program(1,h,i),data:i});if(u||u===0)s+=u;s+='</span>\n	</a>\n</div>\n<div>\n	<a title="Share this photo" class="button share ui-util-dialog-anchor">\n		<i class="ui-icon-share"></i>\n	</a>\n</div>\n\n',u=n.unless.call(t,t["is-fullscreen"],{hash:{},inverse:c.noop,fn:c.program(5,d,i),data:i});if(u||u===0)s+=u;return s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-sidebar-actions",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("charmtabs",function(e){"use strict";var t,n;t={css:{charmItems:"li[data-tab]",contentItems:"div[data-tab]",contentItem:'div[data-tab="{{tab}}"]',charmSelected:"ui-charmtabs-charmitem-selected",contentSelected:"ui-charmtabs-contentitem-selected"}},e.namespace("Views").CharmTabs=n=e.Base.create("CharmTabs",e.FlickrView,[],{initializer:function(e){this._tabs={},this.charmIndicator=null;if(e.activate===!1)return;this.activate()},activate:function(){var e=this,n,r,i=this.get("container");this.charmIndicator=i.one(".photo-charm-indicator")||i.one(".ui-charmtabs-indicator"),r=this.get("selected")+"",i.all(t.css.charmItems).each(function(s){var o=s.getData();e._tabs[o.tab]={tabName:o.tab,contentEl:i.one(t.css.contentItem.replace("{{tab}}",o.tab)),charmEl:s,charmPositionLeft:null};if(!n||o.tab===r)n=o.tab});if(!n)throw new Error('[CharmTabs] No "'+t.css.charmItems+'" elements found.');this.refreshLayout(n),this.attachEvents({":switch":function(t,n){t.halt(),e.select(n.tab)}}),setTimeout(function(){e.charmIndicator&&e.charmIndicator.addClass("active")},100)},refreshLayout:function(e){var t=this;Object.keys(this._tabs).forEach(function(e){t._tabs[e].charmPositionLeft=t._tabs[e].charmEl.get("offsetLeft")}),this.select(e||this.get("selected"),!0)},select:function(e,n){if(!this.getTab(e))return;if(e===this.get("selected")&&!n)return;this.set("selected",e),this.fire("selected",this._tabs[e]),this.update(e,t)},getTab:function(e){return e||(e=this.get("selected")),this._tabs[e]||null},update:function(e,t){var n=this.getTab(e);this.charmIndicator.setStyles({left:n.charmPositionLeft+24+"px",opacity:1}),n.charmEl.siblings(t.css.charmItems).removeClass(t.css.charmSelected),n.charmEl.addClass(t.css.charmSelected),n.contentEl.siblings(t.css.contentItems).removeClass(t.css.contentSelected),n.contentEl.addClass(t.css.contentSelected)},destructor:function(){this.charmIndicator=null,this._tabs=null,this.set("selected",null),this.detachAll()}},{ATTRS:{selected:{value:null}}})},"@VERSION@",{requires:["flickr-view","flickrui-css"]});
YUI.add("flickr-contacts-getListfetcher",function(e){"use strict";function t(t,n){var r=t[0],i=t[1];return r.contacts&&r.contacts.contact&&r.contacts.contact.forEach(function(t){i.exists(t.nsid)||i.add(e.APIHelper.response.parsePerson(t))}),r}function n(t,n){var r=this;return t.extras=(t.extras||"")+", icon_urls, paid_products",e.batch(n.callAPI("flickr.contacts.getList",t),n.getModelRegistry("person-models")).then(function(e){return r._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-contacts-getList-fetcher] failed getting or processing API response:",e),e})}e.namespace("ListFetchers")["flickr-contacts-getList"]={run:n,_processResponse:t}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["person-models"]});
YUI.add("contact-search-box",function(e){var t=function(e){this.options=e,this.options.elValue=this.options.elValue||"value",this.options.hideInitially||[],this._contacts=null,this.queryEl=this.options.el,this.queryElEvent,this.listEl=null,this.init()};t.prototype={init:function(){var t=this;this.queryElEvent=this.queryEl.on("keyup",this.search.bind(this)),this.queryElEvent=this.queryEl.on("up:27",function(e){e.preventDefault(),t.queryEl.blur(),t.hide()}),this.wrapperEl=e.Node.create("<div/>"),this.wrapperEl.addClass("c-contact-search-autocomplete"),this.listEl=e.Node.create("<ul/>"),this.listEl.addClass("contact-list"),this.wrapperEl.appendChild(this.listEl),this.queryEl.ancestor().insertBefore(this.wrapperEl,this.queryEl),this.wrapperEl.appendChild(this.queryEl),this.options.clickContact=this.options.clickContact||function(e){var n=e.target.ancestor("[data-nsid]",!0).getData("nsid");t.select(n)},this.listEl.delegate("click",this.options.clickContact,"li")},getContact:function(e){var t=0,n=this._contacts,r=n.length;for(;t<r;t++)if(n[t].nsid===e&&!n[t].hide)return n[t]},hideFromSearch:function(e){e=e.trim(),this._contacts&&this._contacts.some(function(t){if(t.nsid.trim()===e)return t.hide=!0,!0})},showInSearch:function(e){e=e.trim(),this._contacts&&this._contacts.some(function(t){if(t.nsid.trim()===e)return t.hide=!1,!0})},load:function(e){var t={},n=this,r,i;if(this._busy)return;return this._end=!1,this._busy=!0,t.can_tag=this.options.canTag||0,i=this.options.appContext.getViewer().nsid,r=this.options.appContext.getModel("contacts-models",i),r.then(function(r){return t.page=1,t.perPage=3e3,t.per_page=3e3,n._loadMoreContacts(r,t,e)},function(){n._busy=!1,n.options.onError()})},_loadMoreContacts:function(e,t,n){var r=this,i;return this._busy=!0,this.options.loadingState&&!this.listEl.one("li.loading")&&(i=document.createElement("li"),i.className="loading",i.innerHTML=this.options.loadingState,this.listEl.appendChild(i)),e.getValue("contacts").getPage(t).then(function(i){r.options.appContext.flipper.isFlipped("search-outside-contacts")||(r._busy=!1),r._contacts=(r.processContactModels(i,!0,!0)||[]).concat(r._contacts||[]),n(),t.page<e.getValue("pages")&&(t.page++,r._loadMoreContacts(e,t,n))},function(){r._busy=!1,r.options.onError()})},processContactModels:function(t,n,r){var i=this,s,o,u;try{u=t.map(function(e){return e.toJSON()})||[]}catch(a){u=[]}if(!i.contactIds){i.contactIds={};if(i._contacts)for(o in i._contacts)i.contactIds[o.id]=!0}return u=u.filter(function(e){return!i.contactIds[e.id]}),u.forEach(function(t,n){i.contactIds[t.id]=!0,t.realname=t.realname||t.username,t.isContact=r,t.buddyicon=e.URLHelper.getBuddyIconURL(t.nsid,t.iconfarm,t.iconserver)}),n&&i.options.me&&(s=i.options.me.toJSON(),e.APIHelper.response.agnosticizeFarmPathTransferProtocol(s.buddyicon),s.buddyicon=s.buddyicon["default"],i.contactIds[s.id]=!0,s.me=!0,u.push(s)),i.options.hideInitially&&u.forEach(function(e){i.options.hideInitially.indexOf(e.nsid)>-1&&(e.hide=!0)}),u},destructor:function(){this.queryElEvent&&this.queryElEvent.detach&&this.queryElEvent.detach()},hide:function(e){e&&e.halt();if(!this._visible)return;this._visible=!1,this.options.noShim||this._shimUp(!1),this.listEl.setStyle("display","none"),this.options.onHide&&this.options.onHide()},show:function(){if(this._visible)return;this._visible=!0,this.options.noShim||this._shimUp(),this.listEl.setStyle("display","block");var t={width:e.config.win.innerWidth,height:e.config.win.innerHeight},n=this.options.el.getDOMNode().getBoundingClientRect(),r=this.listEl.getDOMNode().getBoundingClientRect(),i=!this._contacts,s=i&&this.options.upInitially;s||n.top>0&&n.top+r.height+25>t.height&&!this.options.alwaysDownward?(this.listEl.setStyle("top","auto"),this.listEl.setStyle("bottom","25px"),this.options.onOrientationChange&&this.options.onOrientationChange(!0)):(this.listEl.setStyle("top",null),this.listEl.setStyle("bottom",null),this.options.onOrientationChange&&this.options.onOrientationChange(!1)),this.options.onShow()},_shimUp:function(t){if(t===!1){if(!this._shim)return;this._shim.detach("click").remove(),this._shim=null;return}this._shim=e.Node.create("<div/>"),this._shim.addClass(this.options.shim),this._shim.on("click",this.hide.bind(this)),this.wrapperEl.appendChild(this._shim)},select:function(e){typeof e=="string"&&(e=this.getContact(e),this.queryEl.set("value",e.realname)),this.selected=e,this.options.onSelect(e),this.hide()},search:function(){var e=this.queryEl.get(this.options.elValue),t=e.replace(/[^A-Z0-9\s]+/gi,"|").replace(/^\||\|$/g,"").replace(/\s/g,"\\s"),n=this,r,i,s,o=this.options.appContext.getViewer().nsid;this._nameTest(t),this.selected=null,this.abort=!1;if(e.trim()==="")return this.abort=!0,this.hide();this.options.searchNonContacts||(this._end=!0,this._busy=!1);if(this._contacts&&this.options.me&&e==="me")return this.showResults(this._contacts.filter(function(e){return!e.hide&&e.me}).concat(this._contacts.filter(function(e){return!e.hide&&n._matchesQuery(e)})));if(this._isEmail(e))return this.select({email:e,nsid:null});if(/,/.test(e))return this.select(null);if(!this._contacts)return this.showResults(),this.options.signedOut?null:this.load(this.search.bind(this));r=this._contacts.filter(function(e){return!e.hide&&n._matchesQuery(e)}),this.showResults(r),i=n.listEl.getDOMNode(),this.options.searchNonContacts&&(this.options.loadMoreOnScroll&&n.options.appContext.flipper.isFlipped("search-outside-contacts")&&e.length>1?(s=1,clearTimeout(this.searchAllPeople),this.searchInstanceId=Math.random()*999999,this.searchAllPeople=setTimeout(function(){n._searchPeople(e,o,s,n.searchInstanceId,function(){n._busy=!1,n.showResults(n._contacts.filter(function(e){return!e.hide&&n._matchesQuery(e)})),n.listElScrollEvent=n.listEl.on("scroll",function(){n.listEl._node.clientHeight+n.listEl._node.scrollTop===n.listEl._node.scrollHeight&&(s++,n._loadMore(s,o,e))})})},500)):(clearTimeout(this.searchAllPeople),this.searchInstanceId=Math.random()*999999)
)},_loadMore:function(e,t,n){var r=this,i;this._busy=!0,clearTimeout(this.searchAllPeople),this.searchInstanceId=Math.random()*999999,this.searchAllPeople=setTimeout(function(){r.options.loadingState&&!r.listEl.one("li.loading")&&(i=document.createElement("li"),i.className="loading",i.innerHTML=r.options.loadingState,r.listEl.appendChild(i)),r._searchPeople(n,t,e,r.searchInstanceId,function(){r.showResults(r._contacts.filter(function(e){return!e.hide&&r._matchesQuery(e)})),r.listElScrollEvent&&r.listElScrollEvent.detach(),r.listElScrollEvent=r.listEl.on("scroll",function(){r.listEl._node.clientHeight+r.listEl._node.scrollTop===r.listEl._node.scrollHeight&&(e++,r._loadMore(e,t,n))})})},100)},_nameTest:function(e){var t=new RegExp(".*"+e+".*","i");this._matchesQuery=function(e){return t.test(e.username)||t.test(e.realname)||t.test(e.email)}},_searchPeople:function(e,t,n,r,i){var s=this,o,u,a;s._end=!1,this.options.loadingState&&!this.listEl.one("li.loading")&&(u=document.createElement("li"),u.className="loading",u.innerHTML=this.options.loadingState,this.listEl.appendChild(u)),o=s.options.appContext.getModel("contacts-models",t),o.then(function(t){return a=t.search({username:e,page:n}),a.then(function(e){var t=e.people,n=s.processContactModels(t,!1,!1);s._contacts=s._contacts||[],s._contacts=s._contacts.concat(n),s._contacts.some(function(e){return s._matchesQuery(e)})||(s._end=!0),i()},function(){s._end=!0,s._busy=!1,i()})},function(){s._end=!0,s._busy=!1,i()})},_isEmail:function(e,t){/,/.test(e)?e=e.split(/,/):e=[e];var n=/^\s*[\w\-\+_]+(\.[\w\-\+_]+)*\@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*\s*$/;if(t){while(e.length)if(n.test(e.shift().trim()))return!0;return!1}while(e.length)if(!n.test(e.shift().trim()))return!1;return!0},showResults:function(e){if(this.abort)return;var t=this.options.max||10,n,r,i=this;n=document.createDocumentFragment(),!i._busy&&e&&e.length===0?(r=document.createElement("li"),r.innerHTML='<span class="no-contacts">No members found.</span>',n.appendChild(r)):e&&e.slice(0,t).forEach(function(e){var t=i.createItem(e);n.appendChild(t)}),this._busy&&this.options.loadingState&&(r=document.createElement("li"),r.className="loading",r.innerHTML=this.options.loadingState,n.appendChild(r)),this.options.loadMoreOnScroll&&this.listElScrollEvent&&this.listElScrollEvent.detach(),this.listEl.setHTML(""),this.listEl.getDOMNode().appendChild(n),this.show()},_template:['<img src="{{buddyicon}}">','<div class="following-status {{isContact}}">','<span class="following-icon">&nbsp;</span>',"<span>Following</span>","</div>",'<h2 class="all">{{realname}}</h2>','<h3 class="all">{{username}}</h3>'].join(""),_onlyContactTemplate:['<img src="{{buddyicon}}">',"<h2>{{realname}}</h2>","<h3>{{username}}</h3>"].join(""),createItem:function(t){var n=document.createElement("li"),r,i=this.options.searchNonContacts?this._template:this._onlyContactTemplate,s=this.options.truncateLength||70;return r=i.replace(/\{\{(\w+)\}\}/g,function(n,r){if(r==="buddyicon")return t[r];if(r==="isContact")return t[r]?"am-following":"";var i=e.flutil.escapeInput(t[r]);return e.Handlebars.helpers.truncate(i,s)}),n.innerHTML=r,n.dataset?(n.dataset=n.dataset,n.dataset.nsid=t.nsid,n.dataset.displayname=t.realname||t.username,n.dataset.pathAlias=t.pathAlias):(n.setAttribute("data-nsid",t.nsid),n.setAttribute("data-displayname",t.realname||t.username),n.setAttribute("data-path-alias",t.pathAlias)),n}},e.ContactSearchBox=t},"@VERSION@",{requires:["api-helper","flutil","contact-search-css","handlebars-helpers","flickr-contacts-getListfetcher"]});
YUI.add("hermes-template-share",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s;r+="\n			",s=n["if"].call(e,(i=(i=e.networks,i==null||i===!1?i:i.facebook),i==null||i===!1?i:i.accounts),{hash:{},inverse:f.program(4,v,t),fn:f.program(2,d,t),data:t});if(s||s===0)r+=s;return r+="\n		",r}function d(e,t){return'\n				<button class="ui-button ui-button-logo" data-action="compose" data-network="facebook"><i class="ui-icon-big-facebook"></i></button>\n			'}function v(e,t){var r="",i;r+='\n				<button class="ui-button ui-button-logo c-button-connect" data-action="',i=n["if"].call(e,e.user,{hash:{},inverse:f.program(7,g,t),fn:f.program(5,m,t),data:t});if(i||i===0)r+=i;return r+='" data-network="facebook"><i class="ui-icon-big-facebook"></i></button>\n			',r}function m(e,t){return"connect"}function g(e,t){return"composesignedout"}function y(e,t){return'\n			<button class="ui-button ui-button-logo ui-button-disabled" data-action="halt" data-network="facebook"><i class="ui-icon-big-facebook"></i></button>\n		'}function b(e,t){var r="",i,s;r+="\n			",s=n["if"].call(e,(i=(i=e.networks,i==null||i===!1?i:i.twitter),i==null||i===!1?i:i.accounts),{hash:{},inverse:f.program(14,E,t),fn:f.program(12,w,t),data:t});if(s||s===0)r+=s;return r+="\n		",r}function w(e,t){return'\n				<button class="ui-button ui-button-logo" data-action="compose" data-network="twitter"><i class="ui-icon-big-twitter"></i></button>\n			'}function E(e,t){var r="",i;r+='\n				<button class="ui-button ui-button-logo c-button-connect" data-action="',i=n["if"].call(e,e.user,{hash:{},inverse:f.program(7,g,t),fn:f.program(5,m,t),data:t});if(i||i===0)r+=i;return r+='" data-network="twitter"><i class="ui-icon-big-twitter"></i></button>\n			',r}function S(e,t){return'\n			<button class="ui-button ui-button-logo ui-button-disabled" data-action="halt" data-network="twitter"><i class="ui-icon-big-twitter"></i></button>\n		'}function x(e,t){var r="",i,s;r+="\n			",s=n["if"].call(e,(i=(i=e.networks,i==null||i===!1?i:i.tumblr),i==null||i===!1?i:i.accounts),{hash:{},inverse:f.program(21,N,t),fn:f.program(19,T,t),data:t});if(s||s===0)r+=s;return r+="\n		",r}function T(e,t){return'\n				<button class="ui-button ui-button-logo" data-action="compose" data-network="tumblr"><i class="ui-icon-big-tumblr"></i></button>\n			'}function N(e,t){var r="",i;r+='\n				<button class="ui-button ui-button-logo c-button-connect" data-action="',i=n["if"].call(e,e.user,{hash:{},inverse:f.program(7,g,t),fn:f.program(5,m,t),data:t});if(i||i===0)r+=i;return r+='" data-network="tumblr"><i class="ui-icon-big-tumblr"></i></button>\n			',r}function C(e,t){return'\n			<button class="ui-button ui-button-logo ui-button-disabled" data-action="halt" data-network="tumblr"><i class="ui-icon-big-tumblr"></i></button>\n		'}function k(e,t){var r="",i;r+='\n        	<button class="ui-button ui-button-logo" data-action="',i=n["if"].call(e,e.user,{hash:{},inverse:f.program(7,g,t),fn:f.program(26,L,t),data:t});if(i||i===0)r+=i;return r+='" data-network="pinterest"><i class="ui-icon-big-pinterest"></i></button>\n        ',r}function L(e,t){return"compose"}function A(e,t){return'\n        	<button class="ui-button ui-button-logo ui-button-disabled" data-action="halt" data-network="pinterest"><i class="ui-icon-big-pinterest"></i></button>\n        '}function O(e,t){var r="",i;r+='\n			<button class="ui-button ui-button-logo" data-action="',i=n["if"].call(e,e.user,{hash:{},inverse:f.program(7,g,t),fn:f.program(26,L,t),data:t});if(i||i===0)r+=i;return r+='" data-network="mail"><i class="ui-icon-big-mail"></i></button>\n		',r}function M(e,t){return'\n			<button class="ui-button ui-button-logo ui-button-disabled" data-action="halt" data-network="mail"><i class="ui-icon-big-mail"></i></button>\n		'}function _(e,t){return'\n				<li data-tab="bbcode" data-action="switch">BBCode</li>\n			'}function D(e,t,r){var i="",s,o,u;i+="\n					",o=n["if"].call(e,(s=e.model,s==null||s===!1?s:s.isVideo),{hash:{},inverse:f.program(39,H,t),fn:f.program(37,P,t),data:t});if(o||o===0)i+=o;return i+='\n					<input type="text" value="',u={hash:{},data:t},i+=c((s=n.shortUrlPhoto||r.shortUrlPhoto,s?s.call(e,r.model,r.https,u):l.call(e,"shortUrlPhoto",r.model,r.https,u)))+'">\n				',i}function P(e,t){var r="",i,s;return r+="<h3>",s={hash:{intlName:"photo-page-scrappy.LINK_TO_VIDEO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</h3>",r}function H(e,t){var r="",i,s;return r+="<h3>",s={hash:{intlName:"photo-page-scrappy.LINK_TO_PHOTO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</h3>",r}function B(e,t){var r="",i;r+="\n					",i=n["if"].call(e,e.isOwner,{hash:{},inverse:f.program(53,W,t),fn:f.program(42,j,t),data:t});if(i||i===0)r+=i;return r+="\n				",r}function j(e,t){var r="",i,s;r+="\n						",s=n["if"].call(e,(i=e.model,i==null||i===!1?i:i.isVideo),{hash:{},inverse:f.program(48,R,t),fn:f.program(43,F,t),data:t});if(s||s===0)r+=s;return r+="\n					",r}function F(e,t){var r="",i,s,o;r+="\n							<h3>",o={hash:{intlName:"photo-page-scrappy.LINK_TO_VIDEO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</h3>\n							<input type="text" id="share-photo-link">\n							',o={hash:{},inverse:f.program(46,q,t),fn:f.program(44,I,t),data:t},s=(i=n.ifCond||e.ifCond,i?i.call(e,(i=e.model,i==null||i===!1?i:i.safetyLevel),"===",2,o):l.call(e,"ifCond",(i=e.model,i==null||i===!1?i:i.safetyLevel),"===",2,o));if(s||s===0)r+=s;return r+="\n						",r}function I(e,t){var r="",i,s;return r+='\n							    <p class="create-guestpass">',s={hash:{intlName:"photo-page-scrappy.NO_LINKS_FOR_RESTRICTED_VIDEO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</p>\n							",r}function q(e,t){var r="",i,s;return r+='\n							    <p class="create-guestpass">',s={hash:{intlName:"photo-page-scrappy.PRIVATE_VIDEO_SHARE"},data:t},r+=c((i=n.intlMessage||
e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'<button class="ui-dialog-button ui-dialog-button-neutral ui-dialog-button-done"><span>',s={hash:{intlName:"common.YES"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</span></button></p>\n							",r}function R(e,t){var r="",i,s,o;r+="\n							<h3>",o={hash:{intlName:"photo-page-scrappy.LINK_TO_PHOTO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</h3>\n							<input type="text" id="share-photo-link">\n							',o={hash:{},inverse:f.program(51,z,t),fn:f.program(49,U,t),data:t},s=(i=n.ifCond||e.ifCond,i?i.call(e,(i=e.model,i==null||i===!1?i:i.safetyLevel),"===",2,o):l.call(e,"ifCond",(i=e.model,i==null||i===!1?i:i.safetyLevel),"===",2,o));if(s||s===0)r+=s;return r+="\n						",r}function U(e,t){var r="",i,s;return r+='\n								<p class="create-guestpass">',s={hash:{intlName:"photo-page-scrappy.NO_LINKS_FOR_RESTRICTED_PHOTO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</p>\n							",r}function z(e,t){var r="",i,s;return r+='\n							    <p class="create-guestpass">',s={hash:{intlName:"photo-page-scrappy.PRIVATE_PHOTO_SHARE"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'<button class="ui-dialog-button ui-dialog-button-neutral ui-dialog-button-done"><span>',s={hash:{intlName:"common.YES"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</span></button></p>\n							",r}function W(e,t){var r="",i,s;r+="\n						",s=n["if"].call(e,(i=e.model,i==null||i===!1?i:i.isVideo),{hash:{},inverse:f.program(56,V,t),fn:f.program(54,X,t),data:t});if(s||s===0)r+=s;return r+="\n						\n					",r}function X(e,t){var r="",i,s;return r+="<p>",s={hash:{intlName:"photo-page-scrappy.SHARING_RESTRICTED_VIDEO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</p>",r}function V(e,t){var r="",i,s;return r+="<p>",s={hash:{intlName:"photo-page-scrappy.SHARING_RESTRICTED_PHOTO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</p>",r}function $(e,t){var r="",i;r+='\n				<div data-tab="html">\n					<!-- HTMLCODE -->\n					',i=n["if"].call(e,e.canShowPlayr,{hash:{},inverse:f.program(97,vt,t),fn:f.programWithDepth(59,J,t,e),data:t});if(i||i===0)r+=i;r+='\n					<!-- /HTMLCODE -->\n				</div>\n				\n				<div data-tab="bbcode">\n					<!-- BBCODE -->\n					',i=n["if"].call(e,e.canShowPlayr,{hash:{},inverse:f.program(102,yt,t),fn:f.programWithDepth(99,mt,t,e),data:t});if(i||i===0)r+=i;return r+="\n					<!-- /BBCODE -->\n				</div>\n			",r}function J(e,t,r){var i="",s,o;i+='\n\n						<div class="ui-dropdown ui-dropdown-closed c-share-linkembed-embedsizedd">\n							<span class="ui-dialog-arrow"></span>\n							<ul>\n								',o=n.each.call(e,(s=e.model,s==null||s===!1?s:s.orderedSizes),{hash:{},inverse:f.noop,fn:f.programWithDepth(60,K,t,e),data:t});if(o||o===0)i+=o;i+='\n							</ul>\n						</div>\n						<input type="text" name="embedcode" class="c-share-linkembed-embedcode">\n\n						<div class="html-embed-code-options">\n							',o=n["if"].call(e,r.playr,{hash:{},inverse:f.noop,fn:f.program(89,lt,t),data:t});if(o||o===0)i+=o;i+="\n							",o=n["if"].call(e,r.htmlEmbeds,{hash:{},inverse:f.noop,fn:f.program(92,ht,t),data:t});if(o||o===0)i+=o;return i+="\n						</div>\n					",i}function K(e,t,r){var i="",s,o,u;i+='\n									<li data-action="set" data-value="'+c((s=e.key,typeof s===h?s.apply(e):s))+'" data-text="',u={hash:{},inverse:f.noop,fn:f.program(61,Q,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,e.key,"in","sq,q",u):l.call(e,"ifCond",e.key,"in","sq,q",u));if(o||o===0)i+=o;u={hash:{},inverse:f.noop,fn:f.program(63,G,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,e.key,"in","t",u):l.call(e,"ifCond",e.key,"in","t",u));if(o||o===0)i+=o;u={hash:{},inverse:f.noop,fn:f.program(65,Y,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,e.key,"in","s,n",u):l.call(e,"ifCond",e.key,"in","s,n",u));if(o||o===0)i+=o;u={hash:{},inverse:f.noop,fn:f.program(67,Z,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,e.key,"in","m,z,c",u):l.call(e,"ifCond",e.key,"in","m,z,c",u));if(o||o===0)i+=o;u={hash:{},inverse:f.noop,fn:f.program(69,et,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,e.key,"in","l,h,k",u):l.call(e,"ifCond",e.key,"in","l,h,k",u));if(o||o===0)i+=o;u={hash:{},inverse:f.noop,fn:f.program(71,tt,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,e.key,"in","o",u):l.call(e,"ifCond",e.key,"in","o",u));if(o||o===0)i+=o;i+=" ",(o=n.width)?o=o.call(e,{hash:{},data:t}):(o=e.width,o=typeof o===h?o.apply(e):o),i+=c(o)+" &times; ",(o=n.height)?o=o.call(e,{hash:{},data:t}):(o=e.height,o=typeof o===h?o.apply(e):o),i+=c(o)+'">\n										',u={hash:{},inverse:f.noop,fn:f.program(73,nt,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,e.key,"in","sq,q",u):l.call(e,"ifCond",e.key,"in","sq,q",u));if(o||o===0)i+=o;i+="\n										",u={hash:{},inverse:f.noop,fn:f.program(75,rt,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,e.key,"in","t",u):l.call(e,"ifCond",e.key,"in","t",u));if(o||o===0)i+=o;i+="\n										",u={hash:{},inverse:f.noop,fn:f.program(77,it,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,e.key,"in","s,n",u):l.call(e,"ifCond",e.key,"in","s,n",u));if(o||o===0)i+=o;i+="\n										",u={hash:{},inverse:f.noop,fn:f.program(79,st,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,e.key,"in","m,z,c",u):l.call(e,"ifCond",e.key,"in","m,z,c",u));if(o||o===0)i+=o;i+="\n										",u={hash:{},inverse:f.noop,fn:f.program(81,ot,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,e.key,"in","l,h,k",u):l.call(e,"ifCond",e.key,"in","l,h,k",u));if(o||o===0)i+=o;i+="\n										",u={hash:{},inverse:f.noop,fn:f.program(83,ut,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,e.key,"in","o",u):l.call(e,"ifCond",e.key,"in","o",u));if(o||o===0)i+=o;i+=" ",(o=n.width)?o=o.call(e,{hash:{},data:t}):(o=e.width,o=typeof o===h?o.apply(e):o),i+=c(o)+" &times; ",(o=n.height
)?o=o.call(e,{hash:{},data:t}):(o=e.height,o=typeof o===h?o.apply(e):o),i+=c(o)+"\n										\n										",o=n["if"].call(e,r.playr,{hash:{},inverse:f.noop,fn:f.programWithDepth(85,at,t,r),data:t});if(o||o===0)i+=o;i+="\n										",o=n["if"].call(e,r.htmlEmbeds,{hash:{},inverse:f.noop,fn:f.programWithDepth(87,ft,t,r),data:t});if(o||o===0)i+=o;return i+="\n									</li>\n								",i}function Q(e,t){return"Square"}function G(e,t){return"Thumbnail"}function Y(e,t){return"Small"}function Z(e,t){return"Medium"}function et(e,t){return"Large"}function tt(e,t){return"Original"}function nt(e,t){var r,i;return i={hash:{intlName:"common.SQUARE"},data:t},c((r=n.intlMessage||e.intlMessage,r?r.call(e,i):l.call(e,"intlMessage",i)))}function rt(e,t){var r,i;return i={hash:{intlName:"common.THUMBNAIL"},data:t},c((r=n.intlMessage||e.intlMessage,r?r.call(e,i):l.call(e,"intlMessage",i)))}function it(e,t){var r,i;return i={hash:{intlName:"common.SMALL"},data:t},c((r=n.intlMessage||e.intlMessage,r?r.call(e,i):l.call(e,"intlMessage",i)))}function st(e,t){var r,i;return i={hash:{intlName:"common.MEDIUM"},data:t},c((r=n.intlMessage||e.intlMessage,r?r.call(e,i):l.call(e,"intlMessage",i)))}function ot(e,t){var r,i;return i={hash:{intlName:"common.LARGE"},data:t},c((r=n.intlMessage||e.intlMessage,r?r.call(e,i):l.call(e,"intlMessage",i)))}function ut(e,t){var r,i;return i={hash:{intlName:"common.ORIGINAL"},data:t},c((r=n.intlMessage||e.intlMessage,r?r.call(e,i):l.call(e,"intlMessage",i)))}function at(e,t,r){var i="",s,o;return i+='\n											<script type="text/x-embedcode" id="playr-code">\n											<iframe src="'+c((s=r.playrUrl,typeof s===h?s.apply(e):s))+'" width="',(o=n.width)?o=o.call(e,{hash:{},data:t}):(o=e.width,o=typeof o===h?o.apply(e):o),i+=c(o)+'" height="',(o=n.height)?o=o.call(e,{hash:{},data:t}):(o=e.height,o=typeof o===h?o.apply(e):o),i+=c(o)+'" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen></iframe>\n											</script>\n										',i}function ft(e,t,r){var i="",s,o,u;return i+='\n											<script type="text/x-embedcode" id="html-code">\n											<a href="https://',(s=n.host)?s=s.call(e,{hash:{},data:t}):(s=e.host,s=typeof s===h?s.apply(e):s),i+=c(s)+c((s=(s=r.model,s==null||s===!1?s:s.url),typeof s===h?s.apply(e):s))+'" title="',u={hash:{},data:t},i+=c((s=n.fallback||r.fallback,s?s.call(e,(s=r.model,s==null||s===!1?s:s.title),"Untitled",u):l.call(e,"fallback",(s=r.model,s==null||s===!1?s:s.title),"Untitled",u)))+" by "+c((s=(s=(s=r.model,s==null||s===!1?s:s.owner),s==null||s===!1?s:s.displayname),typeof s===h?s.apply(e):s))+', on Flickr"><img src="https:',(o=n.displayUrl)?o=o.call(e,{hash:{},data:t}):(o=e.displayUrl,o=typeof o===h?o.apply(e):o),i+=c(o)+'" width="',(o=n.width)?o=o.call(e,{hash:{},data:t}):(o=e.width,o=typeof o===h?o.apply(e):o),i+=c(o)+'" height="',(o=n.height)?o=o.call(e,{hash:{},data:t}):(o=e.height,o=typeof o===h?o.apply(e):o),i+=c(o)+'" alt="',u={hash:{},data:t},i+=c((s=n.fallback||r.fallback,s?s.call(e,(s=r.model,s==null||s===!1?s:s.title),"Untitled",u):l.call(e,"fallback",(s=r.model,s==null||s===!1?s:s.title),"Untitled",u)))+'"></a>\n											</script>\n										',i}function lt(e,t){var r="",i;r+="\n							    ",i=n.unless.call(e,e.isPrivateAndisOwner,{hash:{},inverse:f.noop,fn:f.program(90,ct,t),data:t});if(i||i===0)r+=i;return r+="\n							",r}function ct(e,t){var r="",i,s;return r+='\n								    <input type="radio" name="code-type" id="code-type-playr" value="playr" data-action="codeTypeSelected" checked="true">\n								    <label for="code-type-playr" data-action="codeTypeSelected">',s={hash:{intlName:"photo-page-scrappy.EMBED"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</label>\n								",r}function ht(e,t){var r="",i;r+="\n								",i=n["if"].call(e,e.isPrivateAndisOwner,{hash:{},inverse:f.program(95,dt,t),fn:f.program(93,pt,t),data:t});if(i||i===0)r+=i;return r+='\n                                <label for="code-type-html" data-action="codeTypeSelected">HTML</label>\n							',r}function pt(e,t){return'\n                                    <input type="radio" name="code-type" id="code-type-html" value="html" data-action="codeTypeSelected" checked="true">\n                                '}function dt(e,t){return'\n                                    <input type="radio" name="code-type" id="code-type-html" value="html" data-action="codeTypeSelected">\n                                '}function vt(e,t){var r="",i,s;return r+="\n					    <p>",s={hash:{intlName:"photo-page-scrappy.SHARING_RESTRICTED_PHOTO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</p>\n					",r}function mt(e,t,r){var i="",s,o;i+='\n\n						<div class="ui-dropdown ui-dropdown-closed c-share-linkembed-embedsizedd">\n							<span class="ui-dialog-arrow"></span>\n							<ul>\n								',o=n.each.call(e,(s=e.model,s==null||s===!1?s:s.sizes),{hash:{},inverse:f.noop,fn:f.programWithDepth(100,gt,t,e,r),data:t});if(o||o===0)i+=o;return i+='\n							</ul>\n						</div>\n						<input type="text" name="embedcode" class="c-share-linkembed-embedcode">\n					',i}function gt(e,t,r,i){var s="",o,u,a;s+='\n									<li data-action="set" data-value="'+c((o=(o=t,o==null||o===!1?o:o.key),typeof o===h?o.apply(e):o))+'" data-text="',a={hash:{},inverse:f.noop,fn:f.program(61,Q,t),data:t},u=(o=n.ifCond||e.ifCond,o?o.call(e,(o=t,o==null||o===!1?o:o.key),"in","sq,q",a):l.call(e,"ifCond",(o=t,o==null||o===!1?o:o.key),"in","sq,q",a));if(u||u===0)s+=u;a={hash:{},inverse:f.noop,fn:f.program(63,G,t),data:t},u=(o=n.ifCond||e.ifCond,o?o.call(e,(o=t,o==null||o===!1?o:o.key),"in","t",a):l.call(e,"ifCond",(o=t,o==null||o===!1?o:o.key),"in","t",a));if(u||u===0)s+=u;a={hash:{},inverse:f.noop,fn:f.program(65,Y,t),data:t},u=(o=n.ifCond||e.ifCond,o?o.call(e,(o=t,o==null||o===!1?o:o.key),"in","s,n",a):l.call(e,"ifCond",(o=t,o==null||o===!1?o:o.key),"in","s,n",a));if(u||u===0)s+=u;a=
{hash:{},inverse:f.noop,fn:f.program(67,Z,t),data:t},u=(o=n.ifCond||e.ifCond,o?o.call(e,(o=t,o==null||o===!1?o:o.key),"in","m,z,c",a):l.call(e,"ifCond",(o=t,o==null||o===!1?o:o.key),"in","m,z,c",a));if(u||u===0)s+=u;a={hash:{},inverse:f.noop,fn:f.program(69,et,t),data:t},u=(o=n.ifCond||e.ifCond,o?o.call(e,(o=t,o==null||o===!1?o:o.key),"in","l,h,k",a):l.call(e,"ifCond",(o=t,o==null||o===!1?o:o.key),"in","l,h,k",a));if(u||u===0)s+=u;a={hash:{},inverse:f.noop,fn:f.program(71,tt,t),data:t},u=(o=n.ifCond||e.ifCond,o?o.call(e,(o=t,o==null||o===!1?o:o.key),"in","o",a):l.call(e,"ifCond",(o=t,o==null||o===!1?o:o.key),"in","o",a));if(u||u===0)s+=u;s+=" ",(u=n.width)?u=u.call(e,{hash:{},data:t}):(u=e.width,u=typeof u===h?u.apply(e):u),s+=c(u)+" &times; ",(u=n.height)?u=u.call(e,{hash:{},data:t}):(u=e.height,u=typeof u===h?u.apply(e):u),s+=c(u)+'">\n										',a={hash:{},inverse:f.noop,fn:f.program(73,nt,t),data:t},u=(o=n.ifCond||e.ifCond,o?o.call(e,(o=t,o==null||o===!1?o:o.key),"in","sq,q",a):l.call(e,"ifCond",(o=t,o==null||o===!1?o:o.key),"in","sq,q",a));if(u||u===0)s+=u;s+="\n										",a={hash:{},inverse:f.noop,fn:f.program(75,rt,t),data:t},u=(o=n.ifCond||e.ifCond,o?o.call(e,(o=t,o==null||o===!1?o:o.key),"in","t",a):l.call(e,"ifCond",(o=t,o==null||o===!1?o:o.key),"in","t",a));if(u||u===0)s+=u;s+="\n										",a={hash:{},inverse:f.noop,fn:f.program(77,it,t),data:t},u=(o=n.ifCond||e.ifCond,o?o.call(e,(o=t,o==null||o===!1?o:o.key),"in","s,n",a):l.call(e,"ifCond",(o=t,o==null||o===!1?o:o.key),"in","s,n",a));if(u||u===0)s+=u;s+="\n										",a={hash:{},inverse:f.noop,fn:f.program(79,st,t),data:t},u=(o=n.ifCond||e.ifCond,o?o.call(e,(o=t,o==null||o===!1?o:o.key),"in","m,z,c",a):l.call(e,"ifCond",(o=t,o==null||o===!1?o:o.key),"in","m,z,c",a));if(u||u===0)s+=u;s+="\n										",a={hash:{},inverse:f.noop,fn:f.program(81,ot,t),data:t},u=(o=n.ifCond||e.ifCond,o?o.call(e,(o=t,o==null||o===!1?o:o.key),"in","l,h,k",a):l.call(e,"ifCond",(o=t,o==null||o===!1?o:o.key),"in","l,h,k",a));if(u||u===0)s+=u;s+="\n										",a={hash:{},inverse:f.noop,fn:f.program(83,ut,t),data:t},u=(o=n.ifCond||e.ifCond,o?o.call(e,(o=t,o==null||o===!1?o:o.key),"in","o",a):l.call(e,"ifCond",(o=t,o==null||o===!1?o:o.key),"in","o",a));if(u||u===0)s+=u;return s+=" ",(u=n.width)?u=u.call(e,{hash:{},data:t}):(u=e.width,u=typeof u===h?u.apply(e):u),s+=c(u)+" &times; ",(u=n.height)?u=u.call(e,{hash:{},data:t}):(u=e.height,u=typeof u===h?u.apply(e):u),s+=c(u)+'\n										<script type="text/x-embedcode">\n										[url=',a={hash:{},data:t},s+=c((o=n.shortUrlPhoto||r.shortUrlPhoto,o?o.call(e,r.model,r.https,a):l.call(e,"shortUrlPhoto",r.model,r.https,a)))+"][img]https:",(u=n.displayUrl)?u=u.call(e,{hash:{},data:t}):(u=e.displayUrl,u=typeof u===h?u.apply(e):u),s+=c(u)+"[/img][/url][url=",a={hash:{},data:t},s+=c((o=n.shortUrlPhoto||r.shortUrlPhoto,o?o.call(e,r.model,r.https,a):l.call(e,"shortUrlPhoto",r.model,r.https,a)))+"]",a={hash:{},data:t},s+=c((o=n.fallback||i.fallback,o?o.call(e,(o=i.model,o==null||o===!1?o:o.title),"Untitled",a):l.call(e,"fallback",(o=i.model,o==null||o===!1?o:o.title),"Untitled",a)))+"[/url] by [url=https://",(u=n.host)?u=u.call(e,{hash:{},data:t}):(u=e.host,u=typeof u===h?u.apply(e):u),s+=c(u)+"/people/"+c((o=r.ownerNSId,typeof o===h?o.apply(e):o))+"/]"+c((o=r.ownerUsername,typeof o===h?o.apply(e):o))+"[/url], on Flickr\n										</script>\n									</li>\n\n								",s}function yt(e,t){var r="",i;r+="\n						",i=n["if"].call(e,e.isOwner,{hash:{},inverse:f.program(105,wt,t),fn:f.program(103,bt,t),data:t});if(i||i===0)r+=i;return r+="\n					",r}function bt(e,t){var r="",i,s;return r+="\n							<p>",s={hash:{intlName:"photo-page-scrappy.PUBLIC_TO_SHARE"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</p>\n						",r}function wt(e,t){var r="",i,s;return r+="\n							<p>",s={hash:{intlName:"photo-page-scrappy.SHARING_RESTRICTED_PHOTO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</p>\n						",r}function Et(e,t){var r="",i;r+='\n				<div data-tab="html">\n					<!-- VIDEO EMBED CODE -->\n					',i=n["if"].call(e,e.canShowPlayr,{hash:{},inverse:f.program(111,Tt,t),fn:f.program(108,St,t),data:t});if(i||i===0)r+=i;return r+="\n						<!-- /VIDEO EMBED CODE -->\n				</div>\n			",r}function St(e,t){var r="",i,s,o;r+="\n						<span>",o={hash:{intlName:"photo-page-scrappy.SIZE"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</span>\n							<input type="text" name="videoEmbedWidth" class="video-embed-width" value="400">\n							<span>x</span>\n							<input type="text" name="videoEmbedHeight" class="video-embed-height" value="225">\n							<div class="video-embed-addTitle">\n								<input type="checkbox" id="add-user-attrib-toVideoEmbed" value="addUserAttrib" data-action="addUserAttrib">\n								<label for="add-user-attrib-toVideoEmbed" data-action="addUserAttrib">',o={hash:{intlName:"photo-page-scrappy.TITLE_AND_OWNER_AT_START"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</label>\n							</div>\n						    <input type="text" name="embedcode" class="c-share-linkembed-videoembedcode" data-action="embedCodeBoxClick" value=\'<object type="application/x-shockwave-flash" width="400" height="225" data="https://',(s=n.host)?s=s.call(e,{hash:{},data:t}):(s=e.host,s=typeof s===h?s.apply(e):s),r+=c(s)+'/apps/video/stewart.swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"><param name="flashvars" value="intl_lang=',(s=n.lang)?s=s.call(e,{hash:{},data:t}):(s=e.lang,s=typeof s===h?s.apply(e):s),r+=c(s)+"&photo_secret=",(s=n.photoSecret)?s=s.call(e,{hash:{},data:t}):(s=e.photoSecret,s=typeof s===h?s.apply(e):s),r+=c(s)+"&photo_id=",(s=n.photoId)?s=s.call(e,{hash:{},data:t}):(s=e.photoId,s=typeof s===h?s.apply(e):s),r+=c(s),s=n["if"].call(e,e.isHD,{hash:{},inverse:f.noop,fn:f.program(109,xt,t),data:t});if(s||s===0)r+=s;r+='"></param><param name="movie" value="https://',
(s=n.host)?s=s.call(e,{hash:{},data:t}):(s=e.host,s=typeof s===h?s.apply(e):s),r+=c(s)+'/apps/video/stewart.swf"></param><param name="bgcolor" value="#000000"></param><param name="allowFullScreen" value="true"></param><embed type="application/x-shockwave-flash" src="https://',(s=n.host)?s=s.call(e,{hash:{},data:t}):(s=e.host,s=typeof s===h?s.apply(e):s),r+=c(s)+'/apps/video/stewart.swf" bgcolor="#000000" allowfullscreen="true" flashvars="intl_lang=',(s=n.lang)?s=s.call(e,{hash:{},data:t}):(s=e.lang,s=typeof s===h?s.apply(e):s),r+=c(s)+"&photo_secret=",(s=n.photoSecret)?s=s.call(e,{hash:{},data:t}):(s=e.photoSecret,s=typeof s===h?s.apply(e):s),r+=c(s)+"&photo_id=",(s=n.photoId)?s=s.call(e,{hash:{},data:t}):(s=e.photoId,s=typeof s===h?s.apply(e):s),r+=c(s),s=n["if"].call(e,e.isHD,{hash:{},inverse:f.noop,fn:f.program(109,xt,t),data:t});if(s||s===0)r+=s;return r+='" width="400" height="225"></embed></object>\'>\n						',r}function xt(e,t){return"&hd_default=false"}function Tt(e,t){var r="",i,s;return r+="\n							<p>",s={hash:{intlName:"photo-page-scrappy.SHARING_RESTRICTED_VIDEO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</p>\n						",r}function Nt(e,t){var r="",i;return r+='\n					<i class="ui-icon-tiny-',(i=n.license)?i=i.call(e,{hash:{},data:t}):(i=e.license,i=typeof i===h?i.apply(e):i),r+=c(i)+'cc"></i>\n				',r}function Ct(e,t){return'\n					<i class="ui-icon-tiny-government"></i>\n				'}function kt(e,t){return'\n					<i class="ui-icon-tiny-noKnown"></i>\n				'}function Lt(e,t){return'\n					<i class="ui-icon-tiny-copyright">&nbsp;</i>\n				'}function At(e,t){var r="",i,s;return r+='\n					<span class="license license-',(i=n.license)?i=i.call(e,{hash:{},data:t}):(i=e.license,i=typeof i===h?i.apply(e):i),r+=c(i)+'">',s={hash:{intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</span>\n				",r}function Ot(e,t){var r="",i,s,o;r+='\n					<span class="license license-',(i=n.license)?i=i.call(e,{hash:{},data:t}):(i=e.license,i=typeof i===h?i.apply(e):i),r+=c(i)+'">\n						',o={hash:{},inverse:f.noop,fn:f.program(124,Mt,t),data:t},s=(i=n.licenseString||e.licenseString,i?i.call(e,e.license,o):l.call(e,"licenseString",e.license,o));if(s||s===0)r+=s;return r+="\n					</span>\n				",r}function Mt(e,t){var r="",i,s;return r+="\n							",s={hash:{intlName:e.key},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"\n						",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=this,l=n.helperMissing,c=this.escapeExpression,h="function";s+='<div class="ui-dialog-wrapper c-share-menu">\n\n	<div class="ui-buttonbar c-share-networks">\n\n		',u=n["if"].call(t,(o=t.networks,o==null||o===!1?o:o.facebook),{hash:{},inverse:f.program(9,y,i),fn:f.program(1,p,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.networks,o==null||o===!1?o:o.twitter),{hash:{},inverse:f.program(16,S,i),fn:f.program(11,b,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.networks,o==null||o===!1?o:o.tumblr),{hash:{},inverse:f.program(23,C,i),fn:f.program(18,x,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.networks,o==null||o===!1?o:o.pinterest),{hash:{},inverse:f.program(28,A,i),fn:f.program(25,k,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.networks,o==null||o===!1?o:o.mail),{hash:{},inverse:f.program(32,M,i),fn:f.program(30,O,i),data:i});if(u||u===0)s+=u;s+='\n\n	</div>\n\n\n	<div class="ui-charmtabs c-share-linkembed">\n		<ul class="ui-charmtabs-icons">\n			<li data-tab="link" data-action="switch">',a={hash:{intlName:"photo-page-scrappy.LINK"},data:i},s+=c((o=n.intlMessage||t.intlMessage,o?o.call(t,a):l.call(t,"intlMessage",a)))+'</li>\n			<li data-tab="html" data-action="switch">HTML</li>\n			',u=n.unless.call(t,(o=t.model,o==null||o===!1?o:o.isVideo),{hash:{},inverse:f.noop,fn:f.program(34,_,i),data:i});if(u||u===0)s+=u;s+='\n		</ul>\n		<div class="ui-charmtabs-content">\n			<span class=\'photo-charm-indicator hide-text\'>\u2191</span>\n			\n			<div data-tab="link" class="ui-charmtabs-contentitem-selected">\n				<!-- LINK -->\n				',u=n["if"].call(t,(o=t.privacy,o==null||o===!1?o:o.isPublic),{hash:{},inverse:f.program(41,B,i),fn:f.programWithDepth(36,D,i,t),data:i});if(u||u===0)s+=u;s+="\n				<!-- /LINK -->\n			</div>\n\n			",u=n.unless.call(t,(o=t.model,o==null||o===!1?o:o.isVideo),{hash:{},inverse:f.noop,fn:f.program(58,$,i),data:i});if(u||u===0)s+=u;s+="\n			",u=n["if"].call(t,(o=t.model,o==null||o===!1?o:o.isVideo),{hash:{},inverse:f.noop,fn:f.program(107,Et,i),data:i});if(u||u===0)s+=u;s+='\n			</div>\n		</div>\n		<div class="license-info">\n			<a href="',a={hash:{},data:i},s+=c((o=n.configVal||t.configVal,o?o.call(t,"licenseUrls",t.license,a):l.call(t,"configVal","licenseUrls",t.license,a)))+'" class="license-url server-only-link" target="_newtab">\n				',u=n["if"].call(t,t.licenseIsCreativeCommons,{hash:{},inverse:f.noop,fn:f.program(113,Nt,i),data:i});if(u||u===0)s+=u;s+="\n				",u=n["if"].call(t,t.licenseisGovt,{hash:{},inverse:f.noop,fn:f.program(115,Ct,i),data:i});if(u||u===0)s+=u;s+="\n				",u=n["if"].call(t,t.licenseisNoLic,{hash:{},inverse:f.noop,fn:f.program(117,kt,i),data:i});if(u||u===0)s+=u;s+="\n				",u=n["if"].call(t,t.licenseisCopy,{hash:{},inverse:f.noop,fn:f.program(119,Lt,i),data:i});if(u||u===0)s+=u;s+="\n				",u=n["if"].call(t,t.licenseIsCreativeCommons,{hash:{},inverse:f.program(123,Ot,i),fn:f.program(121,At,i),data:i});if(u||u===0)s+=u;return s+="\n			</a>\n		</div>\n	</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-modal-facebook",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression,l="function";return s+='<div class="ui-dialog-wrapper c-share-compose c-share-compose-facebook">\n\n	<h1><i class="ui-icon-small-facebook"></i>',u={hash:{intlName:"share-modal.SHARE_ON_FACEBOOK"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+'</h1>\n\n	<form class="ui-form">\n		<fieldset>\n			<legend>'+f((o=(o=t.photo,o==null||o===!1?o:o.title),typeof o===l?o.apply(t):o))+'</legend>\n			<textarea class="ui-u-1" placeholder="Include a message" data-field="message"></textarea>\n		</fieldset>\n		<div class="ui-buttonbar ui-util-alignright">\n			<button type="submit" class="ui-button ui-button-cta" data-action="post"><span>',u={hash:{intlName:"photo-page-scrappy.SHARE_PHOTO"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+'</span></button>\n		</div>\n	</form>\n\n	<div class="c-share-compose-connect">\n		<i>&harr;</i>\n		',u={hash:{intlName:"share-modal.PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_FACEBOOK"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+"\n	</div>\n\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-modal-facebook",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-modal-twitter",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s;r+='\n		| <select data-field="account" class="c-share-dropdown-account">\n			',s=n.each.call(e,(i=(i=e.networks,i==null||i===!1?i:i.twitter),i==null||i===!1?i:i.accounts),{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(s||s===0)r+=s;return r+="\n		</select>\n		",r}function d(e,t){var r="",i;return r+='\n			<option value="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'">@',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===f?i.apply(e):i),r+=l(i)+"</option>\n			",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<div class="ui-dialog-wrapper c-share-compose c-share-compose-twitter">\n	<h1>\n		<i class="ui-icon-small-twitter"></i>\n		',a={hash:{intlName:"share-modal.SHARE_ON_TWITTER"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+"\n		",a={hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i},u=(o=n.ifCond||t.ifCond,o?o.call(t,(o=(o=(o=t.networks,o==null||o===!1?o:o.twitter),o==null||o===!1?o:o.accounts),o==null||o===!1?o:o.length),">",1,a):h.call(t,"ifCond",(o=(o=(o=t.networks,o==null||o===!1?o:o.twitter),o==null||o===!1?o:o.accounts),o==null||o===!1?o:o.length),">",1,a));if(u||u===0)s+=u;return s+='\n	</h1>\n\n	<form class="ui-form">\n		<fieldset>\n			<div class="c-share-twitter-charcounter">\n				<textarea class="ui-u-1" placeholder="',a={hash:{intlName:"share-modal.INCLUDE_A_MESSAGE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'" data-field="message">'+l((o=(o=t.photo,o==null||o===!1?o:o.title),typeof o===f?o.apply(t):o))+'</textarea>\n				<span data-field="message-counter">120</span>\n			</div>\n		</fieldset>\n		<div class="ui-buttonbar ui-util-alignright">\n			<button type="submit" class="ui-button ui-button-cta" data-action="post"><span>',a={hash:{intlName:"photo-page-scrappy.SHARE_PHOTO"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</span></button>\n		</div>\n	</form>\n\n	<div class="c-share-compose-connect">\n		<i>&harr;</i>\n		',a={hash:{intlName:"share-modal.PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_TWITTER"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+"\n	</div>\n\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-modal-twitter",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-modal-mail",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression,l="function";return s+='<div class="ui-dialog-wrapper c-share-compose c-share-compose-mail">\n\n	<h1><i class="ui-icon-small-mail"></i>',u={hash:{intlName:"share-modal.SHARE_VIA_MAIL"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+'</h1>\n	<form class="ui-form">\n		<fieldset>\n			<legend>'+f((o=(o=t.photo,o==null||o===!1?o:o.title),typeof o===l?o.apply(t):o))+'</legend>\n			<input type="text" class="ui-u-1" placeholder="',u={hash:{intlName:"photo-page-scrappy.SCREEN_NAME_OR_EMAIL"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+'" data-field="recipient">\n			<textarea class="ui-u-1" placeholder="Include a message" data-field="message"></textarea>\n		</fieldset>\n		<div class="ui-buttonbar ui-util-alignright">\n			<button type="submit" class="ui-button ui-button-cta" data-action="post"><span>',u={hash:{intlName:"photo-page-scrappy.SHARE_PHOTO"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+"</span></button>\n		</div>\n	</form>\n\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-modal-mail",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-modal-tumblr",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s;r+='\n		| <select data-field="account" class="c-share-dropdown-account">\n			',s=n.each.call(e,(i=(i=e.networks,i==null||i===!1?i:i.tumblr),i==null||i===!1?i:i.accounts),{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(s||s===0)r+=s;return r+="\n		</select>\n		",r}function d(e,t){var r="",i;return r+='\n			<option value="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'">@',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===f?i.apply(e):i),r+=l(i)+"</option>\n			",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<div class="ui-dialog-wrapper c-share-compose c-share-compose-tumblr">\n	<h1>\n		<i class="ui-icon-small-tumblr"></i>\n		',a={hash:{intlName:"share-modal.SHARE_ON_TUMBLR"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+"\n		",a={hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i},u=(o=n.ifCond||t.ifCond,o?o.call(t,(o=(o=(o=t.networks,o==null||o===!1?o:o.tumblr),o==null||o===!1?o:o.accounts),o==null||o===!1?o:o.length),">",1,a):h.call(t,"ifCond",(o=(o=(o=t.networks,o==null||o===!1?o:o.tumblr),o==null||o===!1?o:o.accounts),o==null||o===!1?o:o.length),">",1,a));if(u||u===0)s+=u;return s+='\n	</h1>\n\n	<form class="ui-form">\n		<fieldset>\n			<legend style="max-width: 280px;">'+l((o=(o=t.photo,o==null||o===!1?o:o.title),typeof o===f?o.apply(t):o))+'</legend>\n			<select data-field="publishing" class="c-share-dropdown-publishing">\n				<option value="publish">',a={hash:{intlName:"share-modal.PUBLISH_NOW"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</option>\n				<option value="queue">',a={hash:{intlName:"share-modal.ADD_TO_QUEUE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</option>\n				<option value="draft">',a={hash:{intlName:"share-modal.SAVE_AS_DRAFT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</option>\n			</select>\n			<textarea class="ui-u-1" placeholder="',a={hash:{intlName:"share-modal.INCLUDE_A_MESSAGE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'" data-field="message"></textarea>\n		</fieldset>\n		<div class="ui-buttonbar ui-util-alignright">\n			<button type="submit" class="ui-button ui-button-cta" data-action="post"><span>',a={hash:{intlName:"photo-page-scrappy.SHARE_PHOTO"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</span></button>\n		</div>\n	</form>\n\n	<div class="c-share-compose-connect">\n		<i>&harr;</i>\n		',a={hash:{intlName:"share-modal.PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_TUMBLR"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+"\n	</div>\n\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-modal-tumblr",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-modal-blogger",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="ui-dialog-wrapper c-share-compose c-share-compose-blogger">\n\n	<h1><i class="ui-icon-small-blogger"></i>Share on Blogger</h1>\n\n	<form class="ui-form">\n		<fieldset>\n			<legend>'+a((o=(o=t.photo,o==null||o===!1?o:o.title),typeof o===u?o.apply(t):o))+'</legend>\n			<textarea class="ui-u-1" placeholder="Include a message" data-field="message"></textarea>\n		</fieldset>\n		<div class="ui-buttonbar ui-util-alignright">\n			<button type="submit" class="ui-button ui-button-cta" data-action="post"><span>Share Photo</span></button>\n		</div>\n	</form>\n\n	<div class="c-share-compose-connect">\n		<i>&harr;</i>\n		please authorize Flickr to post on Blogger\n	</div>\n\n</div>',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-modal-blogger",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-link-tumblr",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing;return s+='<a href="',(o=n.pageUrl)?o=o.call(t,{hash:{},data:i}):(o=t.pageUrl,o=typeof o===f?o.apply(t):o),s+=l(o)+'" title="',a={hash:{},data:i},s+=l((o=n.fallback||t.fallback,o?o.call(t,(o=t.model,o==null||o===!1?o:o.title),"Untitled",a):c.call(t,"fallback",(o=t.model,o==null||o===!1?o:o.title),"Untitled",a)))+'">',a={hash:{},data:i},s+=l((o=n.fallback||t.fallback,o?o.call(t,(o=t.model,o==null||o===!1?o:o.title),"Untitled",a):c.call(t,"fallback",(o=t.model,o==null||o===!1?o:o.title),"Untitled",a)))+'</a> by <a href="',(u=n.ownerUrl)?u=u.call(t,{hash:{},data:i}):(u=t.ownerUrl,u=typeof u===f?u.apply(t):u),s+=l(u)+'">'+l((o=(o=(o=t.model,o==null||o===!1?o:o.owner),o==null||o===!1?o:o.displayname),typeof o===f?o.apply(t):o))+"</a> on Flickr.",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-link-tumblr",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-link-blogger",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing;return s+='<div style="font-size: 0.8em; line-height: 1.6em; margin: 0 0 10px 0; padding: 0;">\n	<a href="',(o=n.pageUrl)?o=o.call(t,{hash:{},data:i}):(o=t.pageUrl,o=typeof o===f?o.apply(t):o),s+=l(o)+'" title="',a={hash:{},data:i},s+=l((o=n.fallback||t.fallback,o?o.call(t,(o=t.model,o==null||o===!1?o:o.title),"Untitled",a):c.call(t,"fallback",(o=t.model,o==null||o===!1?o:o.title),"Untitled",a)))+'"><img alt="',a={hash:{},data:i},s+=l((o=n.fallback||t.fallback,o?o.call(t,(o=t.model,o==null||o===!1?o:o.title),"Untitled",a):c.call(t,"fallback",(o=t.model,o==null||o===!1?o:o.title),"Untitled",a)))+" by "+l((o=(o=(o=t.model,o==null||o===!1?o:o.owner),o==null||o===!1?o:o.displayname),typeof o===f?o.apply(t):o))+'" src="'+l((o=(o=t.imgSize,o==null||o===!1?o:o.url),typeof o===f?o.apply(t):o))+'" style="max-width: 100%"></a>\n	<span style="margin: 0;"><a href="',(u=n.pageUrl)?u=u.call(t,{hash:{},data:i}):(u=t.pageUrl,u=typeof u===f?u.apply(t):u),s+=l(u)+'">',a={hash:{},data:i},s+=l((o=n.fallback||t.fallback,o?o.call(t,(o=t.model,o==null||o===!1?o:o.title),"Untitled",a):c.call(t,"fallback",(o=t.model,o==null||o===!1?o:o.title),"Untitled",a)))+'</a>, a photo by <a href="',(u=n.ownerUrl)?u=u.call(t,{hash:{},data:i}):(u=t.ownerUrl,u=typeof u===f?u.apply(t):u),s+=l(u)+'">'+l((o=(o=(o=t.model,o==null||o===!1?o:o.owner),o==null||o===!1?o:o.displayname),typeof o===f?o.apply(t):o))+"</a> on Flickr.</span>\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-link-blogger",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("share-view",function(e){var t=e.Views.dialogs["dialog-tooltip"],n={},r,i,s,o,u;u={debug:!1,transitionTimeout:2e3,defaultEmbedSize:"sq",defaultTab:"html",noPlayrTab:"link",shareRedirectURL:e.url("/authorize.gne?client=1"),networks:{facebook:{clientId:e.config.flickr.facebook.client_id,scope:"offline_access,read_stream,publish_stream,publish_actions",authorizeUrl:"https://www.facebook.com/dialog/oauth",signedOutShareUrl:"https://www.facebook.com/dialog/feed"},twitter:{signedOutShareUrl:"https://twitter.com/share"},tumblr:{signedOutShareUrl:"https://www.tumblr.com/share/photo",shareSize:"c"},pinterest:{defaultDescription:"Flickr photo",signedOutShareUrl:"https://www.pinterest.com/pin/create/button/",shareSize:"c"}},css:{locked:"ui-util-locked",working:"ui-util-working",removed:"ui-util-removed",shim:"c-share-autocomplete-shim",embedTabs:".c-share-linkembed",embedSizeDropdown:".c-share-linkembed-embedsizedd",embedCode:".c-share-linkembed-embedcode"}},o=e.merge(e.flutil,{log:function(){if(!u.debug||!console.log.apply)return;var e=[].slice.call(arguments);e.unshift("SHARE"),o.dump.apply(null,e)}}),e.namespace("Views")[this.name]=e.Base.create("share-view",t,[],{langBundles:this.details.langBundles,initializer:function(n){var r,i=["photo","photostream","set"];this.api=this.appContext.flickrAPI,this.appContext=this.appContext,this.appContext.flipper.isFlipped("https_everything")||this.desecureLinks(),t.prototype.initializer.call(this,n);while(r=i.shift())if(n[r+"Id"]){this.set("modelName",r),this.set("modelId",n[r+"Id"]);break}if(!r)throw new Error("A photo or photolist id is required");return this.set("user",this.appContext.getViewer().signedIn?{}:null),e.Views.dialog.registerView(this,this.modelId),this},initialize:function(){return this.loadState()},userPrevShareOptions:function(t,n){try{return e.StorageHelper.setItem(t,n),!0}catch(r){return!1}},getPlayrUrl:function(t){var n,r;return n=document.location.pathname,n=n.replace(/\/+$/,""),n+="/player/",r=this.appContext.flipper.isFlipped("https_everything")?"https":"http",e.url(n,{protocol:r})},canShowPlayr:function(){var e=this.get("engagement"),t=this.get("privacy"),n=!1,r,i,s;return this.appContext.getViewer().signedIn&&e&&t&&(r=e.toJSON().ownerNsid,i=this.appContext.getViewer().nsid,s=r===i?!0:!1,n=e.getValue("canShare")&&t.getValue("isPublic")||s),n},loadState:function(){var t=this,n,r,i,s;return n=this.appContext.getModel(this.get("modelName")+"-models",this.get("modelId")),r=this.appContext.getModel(this.get("modelName")+"-privacy-models",this.get("modelId")),i=this.appContext.getModel(this.get("modelName")+"-engagement-models",this.get("modelId")),s=new e.FlickrPromise({model:n,privacy:r,engagement:i}),s.then(function(e){t.set("model",e.model),t.set("modelName",e.model.registry.name.split("-")[0]),t.set("privacy",e.privacy),t.set("engagement",e.engagement)}).then(function(){return t.mapLinkedAccounts()}).then(function(e){o.log("NETWORKS",t.get("networks")),t.openShareMenu()}).then(null,this.handleError("loadState"))},hide:function(e){var n=this;this._socialNet&&this._socialNet.close(),t.prototype.hide.call(this,function(){n.get("container").get("parentNode")&&n.openShareMenu(),e&&e()})},show:function(e){t.prototype.show.call(this,e),this.embedTabs&&this.embedTabs.refreshLayout()},desecureLinks:function(){var e;u.shareRedirectURL=u.shareRedirectURL.replace("https://","http://"),Object.keys(u.networks).forEach(function(t){e=u.networks[t],e.authorizeUrl&&(u.networks[t].authorizeUrl=e.authorizeUrl.replace("https://","http://")),e.signedOutShareUrl&&(u.networks[t].signedOutShareUrl=e.signedOutShareUrl.replace("https://","http://"))})},openShareMenu:function(){var t=this,n=this.canShowPlayr(),r=this.get("engagement"),i=this.get("privacy"),s=this.get("model"),o=this.get("networks"),a=!1,f=s?s.getValue("secret"):null,l=s?s.getValue("id"):null,c=!1,h=s?s.getValue("license"):0,p,d,v=this.get("container"),m;i&&!(i.getValue("isPublic")||i.getValue("isPublic")||i.getValue("isPublic"))&&r&&r.getValue("isOwner")&&(c=!0),s&&s.getValue("isVideo")&&(a=!0),s&&s.getValue("owner")&&(p=s.getValue("owner").getValue("username")),r&&r.getValue("ownerNsid")&&(d=r.getValue("ownerNsid")),o&&!o.facebook&&!o.twitter&&!o.tumblr&&!o.pinterest&&(n=!1),this.embedHtmlSizeDd&&this.embedHtmlSizeDd.destroy(),this.embedBbcodeSizeDd&&this.embedBbcodeSizeDd.destroy(),this.embedTabs&&this.embedTabs.destroy(),this.set("playrUrl",this.getPlayrUrl()),this.set("playr",this.appContext.flipper.isFlipped("playr")),this.set("htmlEmbeds",this.appContext.flipper.isFlipped("enable-html-embeds")),this.set("canShowPlayr",n),this.set("isOwner",r&&r.getValue("isOwner")),this.set("isPrivateAndisOwner",c),this.set("isHD",s&&s.getValue("isHD")),this.set("lang",this.appContext.lang),this.set("photoSecret",f),this.set("photoId",l),this.set("ownerUsername",p),this.set("ownerNsid",d),this.set("license",h),this.set("licenseIsCreativeCommons",h!==0&&h!==7&&h!==8),this.set("licenseisGovt",h===8),this.set("licenseisNoLic",h===7),this.set("licenseisCopy",h===0),this.set("https",this.appContext.flipper.isFlipped("https_everything")),this.set("content",this.templates("share")),this.renderContent();if(!this.get("model"))return;this.embedTabs=new e.Views.CharmTabs({appContext:this.appContext,container:this.get("container").one(u.css.embedTabs),selected:n?e.StorageHelper.getItem("previousSelectedShareTab")?e.StorageHelper.getItem("previousSelectedShareTab"):u.defaultTab:u.noPlayrTab}),this.embedTabs.on("selected",function(n){setTimeout(function(){var r=n.contentEl.one("input");if(r)try{r.focus()}catch(i){}t.userPrevShareOptions("previousSelectedShareTab",n.contentEl.getAttribute("data-tab")),!t.get("privacy").getValue("isPublic")&&!t.get("model").getValue("guestpass")&&t.setupGuestpassLink(),t.get("model").getValue("guestpass")&&(e.one("#share-photo-link").set("value",t.get("model").getValue("guestpass")),e.one("#share-photo-link").focus(),e.one("#share-photo-link").select()),e.StorageHelper.getItem("previousSelectedEmbedValue"
)&&n.contentEl.one(".c-share-linkembed-embedsizedd")&&n.contentEl.one(".c-share-linkembed-embedsizedd li.ui-dropdown-item-selected").getAttribute("data-value")!==e.StorageHelper.getItem("previousSelectedEmbedValue")&&(t.embedHtmlSizeDd.select(e.StorageHelper.getItem("previousSelectedEmbedValue")),t.embedBbcodeSizeDd.select(e.StorageHelper.getItem("previousSelectedEmbedValue")))},10)}),n&&(this.embedTabs.getTab("html")&&(a||(this.embedHtmlSizeDd=new e.Views.Dropdown({appContext:this.appContext,container:this.embedTabs.getTab("html").contentEl.one(u.css.embedSizeDropdown),selected:e.StorageHelper.getItem("previousSelectedEmbedValue")?e.StorageHelper.getItem("previousSelectedEmbedValue"):u.defaultEmbedSize}),this.embedHtmlSizeDd.on("selected",function(e){e.clicked?t.setEmbedCode(e.clicked.value,e.clicked.itemEl):t.get("container").one(".c-share-linkembed-embedsizedd ul li.ui-dropdown-item-selected")?t.setEmbedCode(u.defaultEmbedSize,t.get("container").one(".c-share-linkembed-embedsizedd ul li.ui-dropdown-item-selected")):t.embedHtmlSizeDd.select(u.defaultEmbedSize)}),this.embedHtmlSizeDd.select(e.StorageHelper.getItem("previousSelectedEmbedValue")?e.StorageHelper.getItem("previousSelectedEmbedValue"):u.defaultEmbedSize),e.StorageHelper.getItem("selectedEmbedCodeType")&&(e.StorageHelper.getItem("selectedEmbedCodeType")==="playr"&&v.one("#code-type-playr")?v.one("#code-type-playr").setAttribute("checked",!0):v.one("#code-type-html").setAttribute("checked",!0),m=v.one(".c-share-linkembed-embedsizedd ul li.ui-dropdown-item-selected"),t.setEmbedCode(m.getData("value"),m)))),a||(this.embedBbcodeSizeDd=new e.Views.Dropdown({appContext:this.appContext,container:this.embedTabs.getTab("bbcode").contentEl.one(u.css.embedSizeDropdown),selected:e.StorageHelper.getItem("previousSelectedEmbedValue")?e.StorageHelper.getItem("previousSelectedEmbedValue"):u.defaultEmbedSize}),this.embedBbcodeSizeDd.on("selected",function(e){e.clicked?t.setEmbedCode(e.clicked.value,e.clicked.itemEl):t.get("container").one(".c-share-linkembed-embedsizedd ul li.ui-dropdown-item-selected")?t.setEmbedCode(u.defaultEmbedSize,t.get("container").one(".c-share-linkembed-embedsizedd ul li.ui-dropdown-item-selected")):t.embedBbcodeSizeDd.select(u.defaultEmbedSize)}),this.embedBbcodeSizeDd.select(e.StorageHelper.getItem("previousSelectedEmbedValue")?e.StorageHelper.getItem("previousSelectedEmbedValue"):u.defaultEmbedSize)))},setupGuestpassLink:function(){var e=this,t=this.get("container"),n=t.one(".create-guestpass button"),r=t.one(".create-guestpass").siblings("h3"),i=t.one("#share-photo-link");r.hide(),i.hide(),t.one(".create-guestpass").setStyle("display","block"),n&&n.on("click",function(n){e.get("model").getGuestpass(e.get("model").getValue("id")).then(function(n){i.set("value",e.get("model").getValue("guestpass")),r.show(),i.show(),t.one(".create-guestpass").hide(),t.one("#share-photo-link").focus(),t.one("#share-photo-link").select()})})},codeTypeSelected:function(e){e.stopPropagation();var t=this.get("container"),n=t.one(".c-share-linkembed-embedsizedd ul li.ui-dropdown-item-selected");e.target.get("id")==="code-type-playr"||e.target.get("htmlFor")==="code-type-playr"?this.userPrevShareOptions("selectedEmbedCodeType","playr"):this.userPrevShareOptions("selectedEmbedCodeType","html"),this.setEmbedCode(n.getData("value"),n)},embedDimensionsFocusOut:function(e){var t=/[0-9]+/g,n=this.get("container"),r=16/9,i=n.one(".c-share-linkembed-videoembedcode"),s=n.one(".video-embed-width"),o=n.one(".video-embed-height");e.target.get("className")==="video-embed-width"?t.test(s.get("value"))?(o.set("value",Math.round(1/r*s.get("value"))),i.set("value",i.get("value").replace(/width\="[0-9]+"\sheight\="[0-9]+"/g,'width="'+s.get("value")+'" height="'+o.get("value")+'"'))):(s.set("value","400"),o.set("value","225")):t.test(n.one(".video-embed-height").getDOMNode().value)?(s.set("value",Math.round(r*o.get("value"))),i.set("value",i.get("value").replace(/width\="[0-9]+"\sheight\="[0-9]+"/g,'width="'+s.get("value")+'" height="'+o.get("value")+'"'))):(s.set("value","400"),o.set("value","225"))},addUserAttribToVideoEmbed:function(e){e.stopPropagation();var t=this.get("container"),n=t.one(".c-share-linkembed-videoembedcode"),r,i;e.target.get("checked")?(r=n.get("value").indexOf("&photo_id"),n.set("value",n.get("value").slice(0,r)+"&flickr_show_info_box=true"+n.get("value").slice(r)),i=n.get("value").lastIndexOf("&photo_id"),n.set("value",n.get("value").slice(0,i)+"&flickr_show_info_box=true"+n.get("value").slice(i))):n.get("value").indexOf("&flickr_show_info_box=true")!==-1&&n.set("value",n.get("value").replace(/&flickr_show_info_box=true/g,""))},embedCodeBoxClick:function(e){e.stopPropagation(),e.target.select()},setEmbedCode:function(e,t){var n=t.ancestor("[data-tab]").one(u.css.embedCode),r,i=this.get("container"),s;i.one("[name=code-type]:checked")&&t.one("#html-code")?(s=i.one("[name=code-type]:checked").get("value"),s==="html"?r=t.one("#html-code").get("innerHTML").trim():r=t.one("#playr-code").get("innerHTML").trim()):r=t.one("script").get("innerHTML").trim(),n.setAttribute("value",r),n.getDOMNode().select(),this.userPrevShareOptions("previousSelectedEmbedValue",e)},openComposeDialog:function(t){var n,r=this;this._socialNet=n=new t({appContext:this.appContext,model:this.get("model"),privacy:this.get("privacy"),networks:this.get("networks"),parent:this,signedOut:!this.get("user")}),e.rapidTracker.beacon(r.name,"share"+n.get("serviceName")+"NetworkClick"),n.on("posted",function(){r.switchToUIState("complete"),e.rapidTracker.beacon(r.name,"photoSharedTo"+n.get("serviceName")),setTimeout(function(){r.hide(function(){r.switchToUIState("complete",!1),r._socialNet.close(),r._socialNet=null})},2e3)}),n.on("dismissed",function(e){r.hide(function(){r._socialNet.close(),r._socialNet=null})}),n.render(),n.activate(),r.set("content",n),r.renderContent()},openSignedOutComposeDialog:function(t){var n;this._socialNet=n=new t({appContext:this.appContext,model:this
.get("model"),privacy:this.get("privacy"),networks:this.get("networks"),parent:this,signedOut:!this.get("user")}),e.rapidTracker.beacon(this.name,"share"+n.get("serviceName")+"SignedOutNetworkClick"),this._socialNet.composeSignedOut()},openAuthorizeDialog:function(e){this.openComposeDialog(e),this._socialNet.linkAccount()},activate:function(){var e,r=this;return t.prototype.activate.call(this),e={":compose":function(e,t){e.halt();var i="Connect"+o.toCamelCase(t.network);r.openComposeDialog(n[i])},":composesignedout":function(e,t){e.halt();var i="Connect"+o.toCamelCase(t.network);r.openSignedOutComposeDialog(n[i])},":connect":function(e,t){e.halt();var i="Connect"+o.toCamelCase(t.network);this.get("user")?r.openAuthorizeDialog(n[i]):r.openComposeDialog(n[i])},":expand":function(e,t){e.halt(),r.get("container").one('[data-target="expand"]').toggleClass(u.css.removed)},":codeTypeSelected":this.codeTypeSelected,":addUserAttrib":this.addUserAttribToVideoEmbed,".video-embed-width blur:":this.embedDimensionsFocusOut,".video-embed-height blur:":this.embedDimensionsFocusOut,":embedCodeBoxClick":this.embedCodeBoxClick},this.attachEvents(e),this.on("subviewViewEvent",function(e){return r.openShareMenu(),!1}),this},handleError:function(t,n){var r=this,i=["loadState","flickr.sharing.getServiceTypes","flickr.sharing.getServices","flickr.sharing.canShare"];return i.indexOf(t)>=0?function(e){o.log(t,!e.toString||e.toString().match(/^\[object/)?e:e.toString())}:function(n){o.log(t,!n.toString||n.toString().match(/^\[object/)?n:n.toString()),r.fire("subviewViewEvent","getDialogOffset",function(t){var n=e.Views.dialog.getInstance("dialog-alert",{content:r.intlMessage({intlName:"photo-page-scrappy.SOMETHING_WENT_WRONG"})+"<br>"+r.intlMessage({intlName:"photo-page-scrappy.REFRESH_BROWSER"}),attrs:{title:r.intlMessage({intlName:"common.ERROR"}),level:"warning",confirmLabel:r.intlMessage({intlName:"common.OK"})},appContext:r.appContext,offsetLeft:t});n.show()})}.bind(this)},mapLinkedAccounts:function(){var e=this;return this.getLinkedAccounts().then(function(t){e.get("networks")||e.set("networks",{});var n=e.get("networks");Object.keys(t).forEach(function(e){n[t[e].label]=t[e]})})},getLinkedAccounts:function(){return e.batch(this.get("user")?this.api.callMethod("flickr.sharing.getServices",{}):new e.AutoResolvingPromise,this.getNetworks()).then(function(e){var t=e[0],n=e[1]||[],r;try{r=t.services.service||[]}catch(i){r=[]}return r=r.reduce(function(e,t){var n=t.typeId+"";return e[n]||(e[n]=[]),e[n].push(t),e},{}),Object.keys(n).forEach(function(e){n[e].accounts=r[n[e].id]||null}),n},this.handleError("flickr.sharing.getServices"))},getNetworks:function(){var t=this,n,r;return n=["facebook","twitter","tumblr","mail","pinterest"],r=["mail"],this.getNetworkMap().then(function(){var i={},s,o;return i[t.get("modelName")+"_id"]=t.get("model").id,t.get("user")?t.api.callMethod("flickr.sharing.canShare",i):(t.appContext.getViewer().signedIn?o=t.get("engagement").getValue("canShare")?n:r:o=r,s=o.map(function(e){var n,r,i;for(n in t._networkMap){r=t._networkMap[n],i={service_type_id:n};if(r.label===e){i.can_share=1;break}}return i.can_share||(i.can_share=0),i}),new e.AutoResolvingPromise({services:{service:s}}))}).then(function(e){var r;try{r=e.services.service||[]}catch(i){r=[]}return r.push({service_type_id:999,can_share:r.filter(function(e){return e.service_type_id.toString()==="9"&&e.can_share}).length}),r=r.filter(function(e){return e.can_share}).reduce(function(e,r){var i=r.service_type_id+"",s=t._networkMap[i]||{name:"unknown",label:i};return n.indexOf(s.label)<0?e:(e[i]={name:s.name,label:s.label,id:i},e)},{}),r},this.handleError("flickr.sharing.canShare"))},getNetworkMap:function(){var t=this;return this._networkMap={9:{label:"twitter",name:"Twitter"},12:{label:"tumblr",name:"Tumblr"},128:{label:"facebook",name:"Facebook"},129:{label:"yahoo-pulse",name:"Yahoo Pulse"},130:{label:"mail",name:"Mail"},999:{label:"pinterest",name:"Pinterest"}},this._networkMap?new e.AutoResolvingPromise:this.api.callMethod("flickr.sharing.getServiceTypes",{}).then(function(e){var n;try{n=e.service_types.service_type||[]}catch(r){n=[]}t._networkMap=n.reduce(function(e,t){return e[t.id.toString()]={label:t.content.toLowerCase().replace(/\s+/,"-"),name:t.content},e},{})},this.handleError("flickr.sharing.getServiceTypes"))},destructor:function(){this._socialNet&&this._socialNet.close(),t.prototype.destroy.call(this),this.detachAll()},isDebug:function(){return u.debug}}),r=n.Connect=function(t){this.options=e.merge(t),e.FlickrView.apply(this,arguments)},e.extend(r,e.FlickrView,{langBundles:this.details.langBundles,initializer:function(){this.api=this.options.appContext.flickrAPI,this.appContext=this.options.appContext,this.parent=this.options.parent,this.set("model",this.options.model),this.set("privacy",this.options.privacy),this.set("networks",this.options.networks),this.set("signedOut",this.options.signedOut),this.set("modelName",this.options.model.registry.name.split("-")[0]),this.set(this.get("modelName"),this.get("model"))},isPrivate:function(){var e=this.get("privacy");return!e.getValue("isPublic")&&!e.getValue("isVisibleByFriends")&&!e.getValue("isVisibleByFamily")},toJSON:function(){var t=this.getAttrs();return Object.keys(t).reduce(function(n,r){var i=t[r];return i instanceof e.Node?n:i instanceof e.FlickrView?n:(i&&i.toJSON&&(i=i.toJSON()),n[r]=i,n)},{})},render:function(){var e=this.templates(this.get("template"))(this.toJSON());return this.get("container").setHTML(e),this},activate:function(){var e={":post":this.post};return this.attachEvents(e),this},handleError:function(e,t){var n=this;return function(r){o.log(e,!r.toString||r.toString().match(/^\[object/)?r:r.toString());if([10,12,98,99].indexOf(Number(r.code))>=0)return n.linkAccount().then(t);n.parent.handleError(n._class+":"+e)(r)}},handleRetry:function(){var e=this,t=Array.prototype.slice.call(arguments);return function(){t[0].apply(e,t.slice(1))}},linkAccount:function(
){var t=this;return new e.FlickrPromise(function(e,n){t.authorize(function(n){var r={};r.token=n.token,r.service_type_id=t.get("serviceType"),n.hasOwnProperty("expiresIn")&&(r.expires=n.expiresIn/1e3|0||0),n.hasOwnProperty("verifier")&&(r.verifier=n.verifier),t.api.callMethod("flickr.sharing.setToken",r).then(function(n){t.parent.mapLinkedAccounts().then(function(){o.log("NETWORKS-REFRESH",t.get("networks")),e()})})})})},authorize:function(t){var n=this.get("serviceName"),r,i=this;r=e.Views.dialog.getInstance("dialog-cta",{content:this.intlMessage({intlName:"share-modal.AUTHORIZE_TO_SHARE",service:n}),attrs:{title:this.intlMessage({intlName:"share-modal.CONNECT_TO_SERVICE",service:n}),confirmButtonText:this.intlMessage({intlName:"share-modal.OK_TAKE_ME_TO_MY_SETTINGS"})},appContext:i.appContext}),r.on("confirm",function(){document.location="/account/sharing/"}),r.show()},destructor:function(){this._oauthWin&&this._oauthWin.close();var t=this.get("container");t.detach(),t.remove(),this.set("container",null),this.options=null,this.api=null,this.appContext=null,this.set("model",null),this.set("privacy",null),e.FlickrView.prototype.destroy.call(this)},close:function(){this.destructor()}}),r.ATTRS=e.merge(e.FlickrView.ATTRS,{template:{value:"share-modal"},serviceType:{value:"000"},serviceName:{value:"Default"},container:{valueFn:function(){return e.Node.create("<div/>")}}}),n.ConnectFacebook=function(){this._class="ConnectFacebook",r.apply(this,arguments)},e.extend(n.ConnectFacebook,r,{post:function(t){var n={},r=this;return t.halt(),n[this.get("modelName")+"_id"]=this.get("model").id,n.service_type_id=this.get("serviceType"),n.facebook_privacy="friends",this.isPrivate()&&(n.guestpass_private="1"),n.message=o.escapeInput(this.get("container").one('[data-field="message"]').get("value"),"text"),o.log("POST TO FB",n),this.get("container").addClass(u.css.working),e.UA.ie&&r._oauthWin&&r._oauthWin.close(),this.api.callMethod("flickr.sharing.post",n).then(function(e){r.get("container").removeClass(u.css.working),r.fire("posted")},this.handleError("flickr.sharing.post",this.handleRetry(this.post,t)))},composeSignedOut:function(){var t,n,r=this;t={app_id:e.config.flickr.facebook.client_id,display:"popup",link:document.location.href,name:this.get("model").getValue("title"),description:this.get("model").getValue("description"),redirect_uri:u.shareRedirectURL},u.debug&&(t.link=t.link.replace("local.flickr.com",e.config.flickr.url.host)),o.log("ANON POST TO FB",t),this.get("container").addClass(u.css.working),n=o.buildHttpQuery(u.networks.facebook.signedOutShareUrl,t),this._shareWin&&this._shareWin.close(),this._shareWin=o.openPopupWindow(n,{onClose:function(){},onUrlChange:function(){var t,n,i;try{t=r._shareWin.document.location,n=[t.protocol,"//",t.host,t.pathname].join(""),i=u.shareRedirectURL.split("?")[0],u.debug&&n.replace("local.flickr.com",e.config.flickr.url.host),n===i&&r._shareWin&&r._shareWin.close()}catch(s){e.UA.ie&&r._oauthWin&&r._oauthWin.close()}},ui:{}})},authorize:function(e){var t,n,r=this,i;t={client_id:u.networks.facebook.clientId,redirect_uri:u.shareRedirectURL,response_type:"token",scope:u.networks.facebook.scope,display:"popup"},n=o.buildHttpQuery(u.networks.facebook.authorizeUrl,t),i=function(){var t,n;try{t=r._oauthWin.location.hash||""}catch(i){t=""}n=t.slice(1).split(/&/).reduce(function(e,t){var n=t.split(/=/);return e[n[0]]=n[1],e},{}),n.access_token&&(r._oauthWin&&r._oauthWin.close(),e({token:n.access_token,expiresIn:(parseInt(n.expires_in,10)||0)*1e3}))},this._oauthWin&&this._oauthWin.close(),this._oauthWin=o.openPopupWindow(n,{onUrlChange:i,ui:{}})}}),n.ConnectFacebook.ATTRS=e.merge(r.ATTRS,{template:{value:"share-modal-facebook"},serviceType:{value:"128"},serviceName:{value:"Facebook"}}),n.ConnectTwitter=function(){this._class="ConnectTwitter",r.apply(this,arguments)},e.extend(n.ConnectTwitter,r,{activate:function(){function a(r){var i=o.escapeInput(t.get("value"),"text");n.setHTML(""+(s-i.length)),n[i.length>s?"addClass":"removeClass"]("c-share-twitter-charcounter-overflow"),e[i.length>s?"addClass":"removeClass"](u.css.locked)}r.prototype.activate.call(this);var e=this.get("container"),t=e.one('[data-field="message"]'),n=e.one('[data-field="message-counter"]'),i,s=120;a(),i=t.on("keydown",a),this.registerEventHandler(i)},render:function(){r.prototype.render.call(this),this.accountDd=new s(this.get("container").one('[data-field="account"]'))},authorize:function(t){var n={},r=this,i=this.get("container"),s,a,f=!1;n.service_type_id=this.get("serviceType"),i.addClass(u.css.connecting),s=function(){var n=r._oauthWin.location.search||"",s=r._oauthWin.location.hostname||"",o;o=n.slice(1).split(/&/).reduce(function(e,t){var n=t.split(/=/);return e[n[0]]=n[1],e},{});if(o.oauth_token)return f=!0,r._oauthWin.close(),i.removeClass(u.css.connecting),t({token:o.oauth_token,verifier:o.oauth_verifier});s===e.config.flickr.url.host&&a()},a=function(){r._oauthWin.close();if(f)return;i.removeClass(u.css.connecting),r.fire("dismissed")},this.api.callMethod("flickr.sharing.getAuthorizeUrl",n).then(function(e){r._oauthWin&&r._oauthWin.close(),r._oauthWin=o.openPopupWindow(e.authorize_url,{onUrlChange:s,onClose:a,ui:{}})},this.handleError("flickr.sharing.getAuthorizeUrl"))},post:function(e){var t=this.get("container"),n=t.one('[data-field="message"]'),r={},i=this,s;e.halt(),r[this.get("modelName")+"_id"]=this.get("model").id,r.service_type_id=this.get("serviceType"),this.isPrivate()&&(r.guestpass_private="1");try{s=o.escapeInput(this.accountDd.selected,"numericstring"),s||(s=this.get("networks").twitter.accounts[0].id)}catch(a){return this.handleError("flickr.sharing.post")(i.intlMessage({intlName:"photo-page-scrappy.TWITTER_NOT_FOUND"}))}return r.service_id=s,r.message=n.get("value"),o.log("POST TO TWITTER",r),t.addClass(u.css.working),this.api.callMethod("flickr.sharing.post",r).then(function(e){t.removeClass(u.css.working),i.fire("posted")},this.handleError("flickr.sharing.post",this.handleRetry
(this.post,e)))},composeSignedOut:function(){var t,n;t={url:document.location.href},u.debug&&(t.url=t.url.replace("local.flickr.com",e.config.flickr.url.host)),o.log("ANON POST TO TWITTER",t),this.get("container").addClass(u.css.working),n=o.buildHttpQuery(u.networks.twitter.signedOutShareUrl,t),this._shareWin&&this._shareWin.close(),this._shareWin=o.openPopupWindow(n)},destructor:function(){this.accountDd=null,n.Connect.prototype.destroy.call(this)}}),n.ConnectTwitter.ATTRS=e.merge(r.ATTRS,{template:{value:"share-modal-twitter"},serviceType:{value:"9"},serviceName:{value:"Twitter"}}),n.ConnectTumblr=function(){this._class="ConnectTumblr",r.apply(this,arguments)},e.extend(n.ConnectTumblr,r,{render:function(){r.prototype.render.call(this),this.publishingDd=new s(this.get("container").one('[data-field="publishing"]')),this.accountDd=new s(this.get("container").one('[data-field="account"]'))},authorize:n.ConnectTwitter.prototype.authorize,post:function(e){var t=this.get("container"),n=t.one('[data-field="message"]'),r={},i=this,s;e.halt(),r[this.get("modelName")+"_id"]=this.get("model").id,r.service_type_id=this.get("serviceType"),this.isPrivate()&&(r.guestpass_private="1");try{s=o.escapeInput(this.accountDd.selected,"numericstring"),s||(s=this.get("networks").tumblr.accounts[0].id)}catch(a){return this.handleError("flickr.sharing.post")(i.intlMessage({intlName:"photo-page-scrappy.TUMBLR_NOT_FOUND"}))}return r.service_id=s,r.status=o.constrainToValues(this.publishingDd.selected,["publish","queue","draft"]),r.message=o.escapeInput(n.get("value"),"text"),o.log("POST TO TUMBLR",r),t.addClass(u.css.working),this.api.callMethod("flickr.sharing.post",r).then(function(e){t.removeClass(u.css.working),i.fire("posted")},this.handleError("flickr.sharing.post",this.handleRetry(this.post,e)))},composeSignedOut:function(){var t=this.get("model"),n=t.getValue("sizes"),r,i,s=t.getValue("owner").getValue("url"),a=document.location.href,f,l,c;r=n[u.networks.blogger.shareSize],r||(r=t.getLargestSize(t.getValue("id"))),u.debug&&(a=a.replace("local.flickr.com",e.config.flickr.url.host)),i=this.appContext.flipper.isFlipped("https_everything")?"https":"http",s=e.url(s,{protocol:i}),r=n[u.networks.tumblr.shareSize],r||(r=t.getLargestSize(t.getValue("id"))),f=this.templates("share-link-tumblr")(e.merge(this.toJSON(),{imgSize:r,pageUrl:a,ownerUrl:s})),l={source:(this.appContext.flipper.isFlipped("https_everything")?"https:":"http:")+r.url,caption:f,click_thru:a},o.log("ANON POST TO TUMBLR",l),c=o.buildHttpQuery(u.networks.tumblr.signedOutShareUrl,l),this._shareWin&&this._shareWin.close(),this._shareWin=o.openPopupWindow(c)},destructor:function(){this.publishingDd=null,this.accountDd=null,n.Connect.prototype.destroy.call(this)}}),n.ConnectTumblr.ATTRS=e.merge(r.ATTRS,{template:{value:"share-modal-tumblr"},serviceType:{value:"12"},serviceName:{value:"Tumblr"}}),n.ConnectPinterest=function(){this._class="ConnectPinterest",r.apply(this,arguments)},e.extend(n.ConnectPinterest,r,{render:function(e){},show:function(){},hide:function(){},activate:function(){this.post()},post:function(){var e,t,n=this.get("model"),r=n.getValue("sizes"),i=n.getValue("title")||u.networks.pinterest.defaultDescription,s;s=r[u.networks.pinterest.shareSize],s||(s=n.getLargestSize(n.getValue("id"))),e={url:document.location.href,description:i,media:(this.appContext.flipper.isFlipped("https_everything")?"https:":"http:")+s.url},t=o.buildHttpQuery(u.networks.pinterest.signedOutShareUrl,e),this._shareWin&&this._shareWin.close(),this._shareWin=o.openPopupWindow(t,{onClose:function(){},ui:{}}),this.fire("dismissed")},composeSignedOut:function(){this.post()}}),n.ConnectPinterest.ATTRS=e.merge(r.ATTRS,{template:{value:"share-modal-pinterest"},serviceType:{value:"999"},serviceName:{value:"Pinterest"}}),n.ConnectMail=function(){this._class="ConnectMail",r.apply(this,arguments)},e.extend(n.ConnectMail,r,{activate:function(){var e=this;r.prototype.activate.call(this),this.get("container").addClass(u.css.locked),this.contacts=new i({el:this.get("container").one('[data-field="recipient"]'),appContext:this.appContext,shim:u.css.shim,signedOut:this.get("signedOut"),onError:this.handleError("ContactSearchBox"),onShow:function(t){e.get("container").addClass(u.css.locked),e.get("container").on("click",function(t){t.target.get("tagName")!=="INPUT"&&e.get("container").one(".contact-list").getStyle("display")==="block"&&e.get("container").one(".contact-list").setStyle("display","none")}),e.get("container").one("input").on("focus",function(){e.get("container").one(".contact-list").getStyle("display")==="none"&&e.get("container").one(".contact-list li")&&e.get("container").one(".contact-list").setStyle("display","block")})},onSelect:function(t){t?e.get("container").removeClass(u.css.locked):e.get("container").addClass(u.css.locked)}})},post:function(e){var t=this.get("container"),n=t.one('[data-field="message"]'),r={},i=this.get("model"),s=this;e.halt();if(!this.contacts.selected)return;return r[this.get("modelName")+"_id"]=i.id,r.service_type_id=this.get("serviceType"),this.isPrivate()&&(r.guestpass_private="1"),this.contacts.selected.nsid?r.to_flickr=this.contacts.selected.nsid:this.contacts.selected.email&&(r.to_email=this.contacts.selected.email),r.message=o.escapeInput(n.get("value"),"text"),o.log("POST TO MAIL",r),this.get("container").addClass(u.css.working),this.api.callMethod("flickr.sharing.post",r).then(function(e){t.removeClass(u.css.working),s.fire("posted")},this.handleError("flickr.sharing.post"))},composeSignedOut:function(){function i(){n&&n.destroy(),e.SigninHelper.addPendingShare({shareType:"email"})}var t,n,r;r=this.appContext,this.parent.hide(),t=new e.Views["confirmation-dialog-view"]({title:"Oops...",icon:"ui-icon-modal-error",content:"So you want to email a photo huh? Sign in and try again.",confirmButtonLabel:"Sign in",cancelButtonLabel:"Forget it",appContext:r}),t.render(),t.activate(),n=e.Views.dialog.getNewInstance("dialog-modal",{content:t.get
("container"),appContext:r}),n.show(),t.registerEventHandler(t.get("container").one(".ui-dialog-button-confirm").on("click",function(){n.close(),n.destroy(),i()}))},handleError:function(e,t){var n=this;return function(t){n.parent.handleError(n._class+":"+e)(t)}}}),n.ConnectMail.ATTRS=e.merge(r.ATTRS,{template:{value:"share-modal-mail"},serviceType:{value:"130"},serviceName:{value:"Email"}}),i=e.ContactSearchBox,s=function(e,t){this.options=t,this._items=[],this.el=e,this.containerEl=null,this.listEl=null,this.labelEl=null,this.selected=null,this._open=!0,this._handlers=[],this._init()},s.prototype={_init:function(){if(!this.el)return;this._render(),this._handlers=[this.containerEl.delegate("click",this._onClick,"span, li",this)]},_render:function(){var t=this.el.getDOMNode(),n,r,i,s;s="ui-dropdown "+this.el.getDOMNode().className,this.containerEl=e.Node.create('<div class="'+s+'"/>'),this.listEl=n=e.Node.create("<ul/>"),this.labelEl=e.Node.create("<span/>"),this._items=r={},Array.prototype.slice.call(t.options).forEach(function(t){var i,s;i=r[t.value]={value:t.value,label:t.text},s=e.Node.create("<li/>"),s.set("text",i.label),s.setAttribute("data-value",i.value),n.appendChild(s)}),this.containerEl.appendChild(this.labelEl),this.containerEl.appendChild(this.listEl),this.el.setStyle("display","none"),this.el.insert(this.containerEl,"before"),i=t.options[t.selectedIndex]||{},this.select(i.value)},_onClick:function(e){var t=e.target,n=t.get("tagName").toLowerCase();if(n==="li")return this.select(t.getData("value"));if(n==="span")return this.toggle()},select:function(e){this.selected=e||null,this.labelEl.set("text",this.selected?this._items[this.selected].label:"..."),this.close()},open:function(){this._open=!0,this.listEl.setStyle("display","block")},close:function(){this._open=!1,this.listEl.setStyle("display","none")},toggle:function(){this[this._open?"close":"open"]()},destructor:function(){this._handlers.forEach(function(e){e.detach()}),this._handlers=null,this._items=null,this.el=null,this.containerEl=null,this.listEl=null,this.labelEl=null,this.selected=null}}},"@VERSION@",{requires:["flutil","dialog","dropdown","charmtabs","flickr-promise","contact-search-box","url","storage-helper","hermes-template-share","hermes-template-share-modal-facebook","hermes-template-share-modal-twitter","hermes-template-share-modal-mail","hermes-template-share-modal-tumblr","hermes-template-share-modal-blogger","hermes-template-share-link-tumblr","hermes-template-share-link-blogger"],optional:["photo-models","photostream-models","share-css"],langBundles:["photo-page-scrappy","settings","common","share-modal"]});
YUI.add("hermes-lang-share-modal",function(e,t){e.Intl.add("hermes/share-modal","en-US",{SHARE_ON_BLOGGER:["Share on Blogger"],SHARE_PHOTO:["Share Photo"],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_BLOGGER:["please authorize Flickr to post on Blogger"],SHARE_ON_FACEBOOK:["Share on Facebook"],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_FACEBOOK:["please authorize Flickr to post on Facebook"],SHARE_VIA_MAIL:["Share via mail"],SHARE_ON_TUMBLR:["Share on Tumblr"],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_TUMBLR:["please authorize Flickr to post on Tumblr"],PUBLISH_NOW:["Publish now"],ADD_TO_QUEUE:["Add to queue"],SAVE_AS_DRAFT:["Save as draft"],SHARE_ON_TWITTER:["Share on Twitter"],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_TWITTER:["please authorize Flickr to post on Twitter"],SHARE_PHOTOSTREAM:["Share Photostream"],AUTHORIZE_TO_SHARE:["You need to authorize Flickr to share photos on ","${service}"],CONNECT_TO_SERVICE:["Connect to ","${service}"],OK_TAKE_ME_TO_MY_SETTINGS:["OK, take me to my settings"],POST:["Post"],SHARE:["Share"],FRIENDS:["Friends"],FAMILY:["Family"],SCREEN_NAME_OR_EMAIL:["screen name or email"],INCLUDE_A_MESSAGE:["Include a message"],SHARE_THIS_VIA:["Share this via..."],SHARE_PREFERENCES:["share preferences"],GRAB_THE_LINK:["Grab the link"],SHOW_SHORT_URL:["show short URL"],INCLUDE_CONTENT_MARKED_AS:["Include content marked as:"],PS_ITEMS_NOT_PUBLIC:["Some of the items in your photostream aren't public."],HERE_IS_PS_LINK:["Here's a link to this photostream. Just copy and paste!"],YOU_CAN_ADD_GUEST_PASS:['You can add a Guest Pass [<a class="guest-pass-link" title="',"${title}",'" data-action="follow" href="/help/sharing/#2184">?</a>] so that recipients can view them.'],ADD_A_GUEST_PASS:["Add a guest pass"],GUEST_PASS_COPY:["Guest Passes let you share your photos that aren't public. Anyone can see your public photos anytime, whether they're a Flickr member or not. But! If you want to share photos marked as friends, family or private, use a Guest Pass. If you're sharing photos from a set, you can create a Guest Pass that includes any of your photos marked as friends, family, or private. If you're sharing your entire photostream, you can create a Guest Pass that includes photos marked as friends or family (but not your private photos)."],VISIT_GUESTPASS_HISTORY:['You can visit your <a href="/invite/history/guests/" data-action="follow">Guest Pass history</a> at any time to expire the Guest Pass.'],SOMETHING_WRONG:["Something went wrong.<br>Please refresh your browser and try again."],ERROR:["Error"],OK:["OK"],SHARE_GROUP:["Share Group"],MESSAGE:["Message"],EMAIL:["Email"]})},"@VERSION@",{requires:["intl"]});
